<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /><link rel="stylesheet" href="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for TrackWings_FitWings_Peak</title><link rel="stylesheet" href="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">TrackWings_FitWings_Peak (320000 calls, 275.592 sec, 886732.70 Kb, 737935.53 Kb, 555.72 Kb)</span><br/><i>Generated 03-Apr-2014 11:11:54 using cpu time.</i><br/>function in file /Users/juan/Documents/janelia/cbtrack_GUI/TrackWings_FitWings_Peak.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file283.html">TrackWings_FitWings_GUI</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">320000</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Allocated Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Freed Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Peak Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line7">7</a></td><td class="td-linebottomrt"><pre>smoothfrac = conv(frac,params....</pre></td><td class="td-linebottomrt">320000</td><td class="td-linebottomrt">46.618 s</td><td class="td-linebottomrt">158602.45 Kb</td><td class="td-linebottomrt">32647.00 Kb</td><td class="td-linebottomrt">400.00 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">16.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=17 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line42">42</a></td><td class="td-linebottomrt"><pre>wing_angles_curr = median(dthe...</pre></td><td class="td-linebottomrt">213757</td><td class="td-linebottomrt">24.073 s</td><td class="td-linebottomrt">143115.53 Kb</td><td class="td-linebottomrt">147150.25 Kb</td><td class="td-linebottomrt">463.39 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">8.7%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=9 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line17">17</a></td><td class="td-linebottomrt"><pre>isallowed = [true,smoothfrac(2...</pre></td><td class="td-linebottomrt">299970</td><td class="td-linebottomrt">18.967 s</td><td class="td-linebottomrt">43196.59 Kb</td><td class="td-linebottomrt">1321.61 Kb</td><td class="td-linebottomrt">452.14 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">6.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line149">149</a></td><td class="td-linebottomrt"><pre>wingtrx = struct('wing_anglel'...</pre></td><td class="td-linebottomrt">320000</td><td class="td-linebottomrt">16.001 s</td><td class="td-linebottomrt">70538.62 Kb</td><td class="td-linebottomrt">1930.08 Kb</td><td class="td-linebottomrt">555.72 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">5.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line19">19</a></td><td class="td-linebottomrt"><pre>isallowed(max(1,loc-params.win...</pre></td><td class="td-linebottomrt">299970</td><td class="td-linebottomrt">13.212 s</td><td class="td-linebottomrt">790.77 Kb</td><td class="td-linebottomrt">3629.39 Kb</td><td class="td-linebottomrt">400.00 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">4.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">156.722 s</td><td class="td-linebottomrt">470488.73 Kb</td><td class="td-linebottomrt">551257.20 Kb</td><td class="td-linebottomrt">555.72 Kb</td><td class="td-linebottomrt">56.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=57 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">275.592 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">886732.70 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">737935.53 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">555.72 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Allocated Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Freed Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Peak Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file280.html">conv</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">320000</td><td class="td-linebottomrt">38.362 s</td><td class="td-linebottomrt">158107.31 Kb</td><td class="td-linebottomrt">32094.44 Kb</td><td class="td-linebottomrt">400.00 Kb</td><td class="td-linebottomrt">13.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=14 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file281.html">median</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">213757</td><td class="td-linebottomrt">20.762 s</td><td class="td-linebottomrt">142852.44 Kb</td><td class="td-linebottomrt">138353.17 Kb</td><td class="td-linebottomrt">463.39 Kb</td><td class="td-linebottomrt">7.5%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">216.468 s</td><td class="td-linebottomrt">585772.95 Kb</td><td class="td-linebottomrt">567487.92 Kb</td><td class="td-linebottomrt">555.72 Kb</td><td class="td-linebottomrt">78.5%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=79 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">275.592 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">886732.70 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">737935.53 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">555.72 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/>No Code Analyzer messages.<div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">161</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">46</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">115</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">112</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">3</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">97.39 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table border = "0" cellpadding = "1" cellspacing = "5"><style> td,th { text-align:center; } .leftAligned{ text-align:left; }</style><tr><th><span style="color: #FF0000; font-weight: bold; text-decoration: none">time</span> </th><th><span style="color: #0000FF; font-weight: bold; text-decoration: none">calls</span> </th><th><span style="color: #20AF20; font-weight: bold; text-decoration: none">mem</span> </th><th class="leftAligned"><span style="font-weight: bold; text-decoration: none">  line</span></th></tr><tr><td></td><td></td><td> (320000 calls, 275.592 sec, 886732.70 Kb, 737935.53 Kb, 555.72 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function wingtrx = TrackWings_FitWings_Peak(dthetawing,params)</span><br/></pre></td></tr><tr><td></td><td></td><td> (320000 calls, 275.592 sec, 886732.70 Kb, 737935.53 Kb, 555.72 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.08 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">    14.9m/79.6k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">   3</span> <span style="color: #000000; background: #FFFFFF;">nwingpx = numel(dthetawing); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 12.62 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">     152m/335k/484k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">   4</span> <span style="color: #000000; background: #FFE2E2;">frac = histc(dthetawing,params.edges_dthetawing)/nwingpx; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.47 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">    237k/289k/64.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">   5</span> <span style="color: #000000; background: #FFFFFF;">frac = frac(:)'; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  5.86 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">     223k/5.97m/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">   6</span> <span style="color: #000000; background: #FFF0F0;">frac = [frac(1:end-2),frac(end-1)+frac(end)]; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 46.62 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">    155m/31.9m/400k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">   7</span> <a name="Line7"></a><span style="color: #000000; background: #FF8080;">smoothfrac = <a href="file280.html">conv</a>(frac,params.wing_frac_filter,'same'); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    155m/31.9m/400k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%smoothfrac = imfilter(frac,params.wing_frac_filter);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    155m/31.9m/400k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">% wings are at local maxima</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    155m/31.9m/400k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    155m/31.9m/400k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">% this is much faster than calling the findpeaks function</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.50 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">     529k/262k/416k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  12</span> <span style="color: #000000; background: #FFFFFF;">locs = []; %pks = []; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.99 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">      107k/154k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  13</span> <span style="color: #000000; background: #FFFFFF;">if nwingpx &gt; params.min_single_wing_area, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  6.06 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">    18.7m/898k/129k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  14</span> <span style="color: #000000; background: #FFF0F0;">  [pk,loc] = max(smoothfrac); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.05 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">   66.8k/378k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  15</span> <span style="color: #000000; background: #FFFFFF;">  if pk &gt;= params.wing_min_peak_threshold_frac, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.81 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">     13.9m/562k/42k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  16</span> <span style="color: #000000; background: #FFFFFF;">    locs(1) = loc; %pks(1) = pk; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 18.97 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">   42.2m/1.29m/452k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  17</span> <a name="Line17"></a><span style="color: #000000; background: #FFC6C6;">    isallowed = [true,smoothfrac(2:end)&gt;smoothfrac(1:end-1)] &amp; ... </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   42.2m/1.29m/452k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  18</span> <span style="color: #000000; background: #FFC6C6;">      [smoothfrac(1:end-1)&gt;=smoothfrac(2:end),true];</span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 13.21 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">    791k/3.54m/400k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  19</span> <a name="Line19"></a><span style="color: #000000; background: #FFE2E2;">    isallowed(max(1,loc-params.wing_min_peak_dist_bins):min(params.nbins_dthetawing,loc+params.wing_min_peak_dist_bins)) = false; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  5.09 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">    444k/466k/80.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  20</span> <span style="color: #000000; background: #FFF0F0;">    [pk,loc] = max(smoothfrac(isallowed)); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.71 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">   200k/81.4k/96.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  21</span> <span style="color: #000000; background: #FFFFFF;">    if pk &gt;= params.wing_peak_min_frac, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.65 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">  5.84m/16.4k/1.53k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  22</span> <span style="color: #000000; background: #FFFFFF;">      idxallowed = find(isallowed); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.81 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">    19k/1.34m/1.08k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  23</span> <span style="color: #000000; background: #FFFFFF;">      locs(2) = idxallowed(loc); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    19k/1.34m/1.08k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">      %pks(2) = pk;</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.59 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">  85.8k/24.4k/64.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  25</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.01 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">  62.7k/91.8k/1.34k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  26</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.01 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  27</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">% [pks,locs] = findpeaks(smoothfrac,'MinPeakHeight',params.wing_peak_min_frac,...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%   'MinPeakDistance',params.wing_min_peak_dist_bins,...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%   'Threshold',params.wing_min_peak_threshold_frac,...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%   'NPeaks',2,...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%   'SortStr','descend');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">      </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   110k/60.5k/52.8k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">% sub-bin precision</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  4.13 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">      539k/176k/64k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  36</span> <span style="color: #000000; background: #FFFFFF;">if isempty(locs), </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.09 </span></td><td><span style="color: #0000FF">  20030 </span></td><td><span style="color: #20AF20">   3.66k/3.12k/464b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  37</span> <span style="color: #000000; background: #FFFFFF;">  wing_angles_curr = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.08 </span></td><td><span style="color: #0000FF">  20030 </span></td><td><span style="color: #20AF20">  4.67k/4.08k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  38</span> <span style="color: #000000; background: #FFFFFF;">  npeaks = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.10 </span></td><td><span style="color: #0000FF">  20030 </span></td><td><span style="color: #20AF20">   3.38k/5.14k/480b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  39</span> <span style="color: #000000; background: #FFFFFF;">  area = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.32 </span></td><td><span style="color: #0000FF">  20030 </span></td><td><span style="color: #20AF20">   3.15m/1.58k/400k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  40</span> <span style="color: #000000; background: #FFFFFF;">  wing_trough_angle = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.62 </span></td><td><span style="color: #0000FF"> 299970 </span></td><td><span style="color: #20AF20">     643k/218k/420k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  41</span> <span style="color: #000000; background: #FFFFFF;">elseif numel(locs) == 1, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 24.07 </span></td><td><span style="color: #0000FF"> 213757 </span></td><td><span style="color: #20AF20">     140m/144m/463k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  42</span> <a name="Line42"></a><span style="color: #000000; background: #FFB8B8;">  wing_angles_curr = <a href="file281.html">median</a>(dthetawing); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.65 </span></td><td><span style="color: #0000FF"> 213757 </span></td><td><span style="color: #20AF20">      75k/44.5k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  43</span> <span style="color: #000000; background: #FFFFFF;">  npeaks = 1; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.52 </span></td><td><span style="color: #0000FF"> 213757 </span></td><td><span style="color: #20AF20">  41.8k/42.5k/1.36k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  44</span> <span style="color: #000000; background: #FFFFFF;">  area = nwingpx; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.50 </span></td><td><span style="color: #0000FF"> 213757 </span></td><td><span style="color: #20AF20">  29.5m/35.2k/32.6k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  45</span> <span style="color: #000000; background: #FFFFFF;">  wing_trough_angle = wing_angles_curr; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.42 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">    48.5k/23.3k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  46</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.66 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">   3.96m/48.3k/544b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  47</span> <span style="color: #000000; background: #FFFFFF;">  wing_angles_curr = params.centers_dthetawing(locs); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.54 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">  40.4k/23.1k/19.7k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  48</span> <span style="color: #000000; background: #FFFFFF;">  npeaks = 2; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  40.4k/23.1k/19.7k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.66 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">   18.6m/24.8k/123k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  50</span> <span style="color: #000000; background: #FFFFFF;">  for j = 1:numel(locs), </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.47 </span></td><td><span style="color: #0000FF"> 172426 </span></td><td><span style="color: #20AF20">    659k/63.8k/432k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  51</span> <span style="color: #000000; background: #FFFFFF;">    subbin_x_curr = params.subbin_x+locs(j); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  5.78 </span></td><td><span style="color: #0000FF"> 172426 </span></td><td><span style="color: #20AF20">   6.24m/82.8k/458k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  52</span> <span style="color: #000000; background: #FFF0F0;">    subbin_x_curr(subbin_x_curr &lt; 1 | subbin_x_curr &gt; params.nbins_dthetawing) = []; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.71 </span></td><td><span style="color: #0000FF"> 172426 </span></td><td><span style="color: #20AF20">  40.2k/67.1k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  53</span> <span style="color: #000000; background: #FFFFFF;">    ncurr = numel(subbin_x_curr); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.87 </span></td><td><span style="color: #0000FF"> 172426 </span></td><td><span style="color: #20AF20">   17.2m/145k/43.7k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  54</span> <span style="color: #000000; background: #FFFFFF;">    Xcurr = [ones(ncurr,1),  subbin_x_curr,  subbin_x_curr.^2]; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   17.2m/145k/43.7k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   17.2m/145k/43.7k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">    % frac = X*coeffs</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  9.42 </span></td><td><span style="color: #0000FF"> 172426 </span></td><td><span style="color: #20AF20">  5.63m/4.43m/87.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  57</span> <span style="color: #000000; background: #FFE2E2;">    coeffs = Xcurr\smoothfrac(subbin_x_curr)'; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  5.63m/4.43m/87.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  5.63m/4.43m/87.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">    % max(c1 + c2*x + c3*x^2)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  5.63m/4.43m/87.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">    % c2 + 2*c3*x = 0</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  5.63m/4.43m/87.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">    % x = -c2 / (2*c3)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  5.63m/4.43m/87.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  5.63m/4.43m/87.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">    % make sure it is concave</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.91 </span></td><td><span style="color: #0000FF"> 172426 </span></td><td><span style="color: #20AF20">    457k/41.1k/388k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  64</span> <span style="color: #000000; background: #FFFFFF;">    if coeffs(3) &gt;= 0, </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    181 </span></td><td><span style="color: #20AF20">        0b/8.19k/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  65</span> <span style="color: #000000; background: #FFFFFF;">      continue; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">        0b/8.19k/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  66</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">        0b/8.19k/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.59 </span></td><td><span style="color: #0000FF"> 172245 </span></td><td><span style="color: #20AF20">  71.9k/39.5k/41.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  68</span> <span style="color: #000000; background: #FFFFFF;">    maxx = -coeffs(2)/(2*coeffs(3)); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  71.9k/39.5k/41.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  71.9k/39.5k/41.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">    % make sure it is within range</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.67 </span></td><td><span style="color: #0000FF"> 172245 </span></td><td><span style="color: #20AF20">  36.3k/31.1k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  71</span> <span style="color: #000000; background: #FFFFFF;">    if abs(maxx-locs(j)) &gt; 1 || maxx &gt; params.nbins_dthetawing || maxx &lt; 1, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    142 </span></td><td><span style="color: #20AF20">    192b/7.56k/192b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  72</span> <span style="color: #000000; background: #FFFFFF;">      continue; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    192b/7.56k/192b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  73</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    192b/7.56k/192b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    192b/7.56k/192b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;">    % interpolate</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.49 </span></td><td><span style="color: #0000FF"> 172103 </span></td><td><span style="color: #20AF20">  30.1k/34.5k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  76</span> <span style="color: #000000; background: #FFFFFF;">    wceil = maxx-floor(maxx); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.26 </span></td><td><span style="color: #0000FF"> 172103 </span></td><td><span style="color: #20AF20">   7.96m/448k/32.1k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  77</span> <span style="color: #000000; background: #FFFFFF;">    wing_angles_curr(j) = params.centers_dthetawing(floor(maxx))*(1-wceil) + wceil*params.centers_dthetawing(ceil(maxx)); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   7.96m/448k/32.1k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.29 </span></td><td><span style="color: #0000FF"> 172103 </span></td><td><span style="color: #20AF20">   192k/5.28m/64.4k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  79</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   192k/5.28m/64.4k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   192k/5.28m/64.4k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;">  % can't have two wings on the same side of the body</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.52 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">    16.5k/981k/464b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  82</span> <span style="color: #000000; background: #FFFFFF;">  if sign(wing_angles_curr(1)) == sign(wing_angles_curr(2)) &amp;&amp; ... </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    16.5k/981k/464b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  83</span> <span style="color: #000000; background: #FFFFFF;">      min(abs(wing_angles_curr)) &gt;= params.min_nonzero_wing_angle,</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.08 </span></td><td><span style="color: #0000FF">   8324 </span></td><td><span style="color: #20AF20">   1.31k/3.16k/224b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  84</span> <span style="color: #000000; background: #FFFFFF;">    wing_angles_curr(end) = []; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.02 </span></td><td><span style="color: #0000FF">   8324 </span></td><td><span style="color: #20AF20">    1.62k/832b/432b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  85</span> <span style="color: #000000; background: #FFFFFF;">    npeaks = 1; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.07 </span></td><td><span style="color: #0000FF">   8324 </span></td><td><span style="color: #20AF20">    35.2k/1.66k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  86</span> <span style="color: #000000; background: #FFFFFF;">    area = nwingpx; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.27 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">   15.1k/16.9k/464b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  87</span> <span style="color: #228B22; background: #FFFFFF;">  else </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   15.1k/16.9k/464b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   15.1k/16.9k/464b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  89</span> <span style="color: #228B22; background: #FFFFFF;">    % find the trough between the two peaks</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.91 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">  15.5k/4.34m/1.41k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  90</span> <span style="color: #000000; background: #FFFFFF;">    minloc = min(locs); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.72 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">  18.9k/18.3k/1.08k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  91</span> <span style="color: #000000; background: #FFFFFF;">    maxloc = max(locs); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.12 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">    3.66m/18.1k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  92</span> <span style="color: #000000; background: #FFFFFF;">    [~,troughloc] = min(smoothfrac(minloc:maxloc)); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.62 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">   122k/22.2k/69.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  93</span> <span style="color: #000000; background: #FFFFFF;">    troughloc = troughloc + minloc - 1; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   122k/22.2k/69.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">    % find other locations with the same value</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.00 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">   14.1m/441k/32.2k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  95</span> <span style="color: #000000; background: #FFFFFF;">    loc1 = find(smoothfrac(minloc:troughloc)&gt;smoothfrac(troughloc),1,'last'); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.74 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">  26.5k/56.4k/4.05k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  96</span> <span style="color: #000000; background: #FFFFFF;">    if isempty(loc1), </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.04 </span></td><td><span style="color: #0000FF">   4551 </span></td><td><span style="color: #20AF20">    416b/1.94k/320b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  97</span> <span style="color: #000000; background: #FFFFFF;">      loc1 = troughloc; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.24 </span></td><td><span style="color: #0000FF">  73338 </span></td><td><span style="color: #20AF20">    44.3k/13.7k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  98</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.38 </span></td><td><span style="color: #0000FF">  73338 </span></td><td><span style="color: #20AF20">      61.5k/14k/42k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  99</span> <span style="color: #000000; background: #FFFFFF;">      loc1 = loc1+minloc; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.42 </span></td><td><span style="color: #0000FF">  73338 </span></td><td><span style="color: #20AF20">   16.5k/23.2k/496b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 100</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.28 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">   3.95m/28.5k/180k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 101</span> <span style="color: #000000; background: #FFFFFF;">    loc2 = find(smoothfrac(troughloc:maxloc)&gt;smoothfrac(troughloc),1,'first'); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.29 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">    15.8k/17k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 102</span> <span style="color: #000000; background: #FFFFFF;">    if isempty(loc2), </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    15.8k/17k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 103</span> <span style="color: #A0A0A0; background: #FFFFFF;">      loc2 = troughloc;</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.30 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">   15.3k/436k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 104</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.27 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">  61.1k/36.8k/42.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 105</span> <span style="color: #000000; background: #FFFFFF;">      loc2 = loc2+troughloc-2; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.23 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">   17.3k/17.4k/448b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 106</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.23 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">     12k/22.5k/416b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 107</span> <span style="color: #000000; background: #FFFFFF;">    troughloc = (loc1+loc2)/2; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.26 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">  13.2k/14.2k/1.28k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 108</span> <span style="color: #000000; background: #FFFFFF;">    if mod(troughloc,1) &gt; 0, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.37 </span></td><td><span style="color: #0000FF">  25648 </span></td><td><span style="color: #20AF20">  12.1k/49.3k/1.22k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 109</span> <span style="color: #000000; background: #FFFFFF;">      area = sum(smoothfrac(1:troughloc-.5)); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">  25648 </span></td><td><span style="color: #20AF20">   5.03k/9.41k/496b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 110</span> <span style="color: #000000; background: #FFFFFF;">      wing_trough_angle = (params.centers_dthetawing(troughloc-.5)+params.centers_dthetawing(troughloc+.5))/2; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">  52241 </span></td><td><span style="color: #20AF20">  15.8k/8.33k/4.05k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 111</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.77 </span></td><td><span style="color: #0000FF">  52241 </span></td><td><span style="color: #20AF20">   12.6k/64.8k/560b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 112</span> <span style="color: #000000; background: #FFFFFF;">      area = sum(smoothfrac(1:troughloc-1))+smoothfrac(troughloc)/2; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.16 </span></td><td><span style="color: #0000FF">  52241 </span></td><td><span style="color: #20AF20">    8.88k/9.5k/432b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 113</span> <span style="color: #000000; background: #FFFFFF;">      wing_trough_angle = params.centers_dthetawing(troughloc); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">  52241 </span></td><td><span style="color: #20AF20">   10.4k/10.9k/448b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 114</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.01 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">  3.81m/94.9k/4.34k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 115</span> <span style="color: #000000; background: #FFFFFF;">    area = [area,1-area]*nwingpx; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  3.81m/94.9k/4.34k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.62 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">    3.62m/37.2k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 117</span> <span style="color: #000000; background: #FFFFFF;">    if all(area &lt; params.min_single_wing_area), </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    642 </span></td><td><span style="color: #20AF20">    3.62m/37.2k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 118</span> <span style="color: #000000; background: #FFFFFF;">      wing_angles_curr = 0; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    642 </span></td><td><span style="color: #20AF20">    3.62m/37.2k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 119</span> <span style="color: #000000; background: #FFFFFF;">      npeaks = 0; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    642 </span></td><td><span style="color: #20AF20">    3.62m/37.2k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 120</span> <span style="color: #000000; background: #FFFFFF;">      area = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.01 </span></td><td><span style="color: #0000FF">    642 </span></td><td><span style="color: #20AF20">        0b/30.2k/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 121</span> <span style="color: #000000; background: #FFFFFF;">      wing_trough_angle = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.97 </span></td><td><span style="color: #0000FF">  77247 </span></td><td><span style="color: #20AF20">   29.8k/135k/4.05k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 122</span> <span style="color: #000000; background: #FFFFFF;">    elseif area(1) &lt; params.min_single_wing_area, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.07 </span></td><td><span style="color: #0000FF">   7503 </span></td><td><span style="color: #20AF20">    354k/1.39k/560b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 123</span> <span style="color: #000000; background: #FFFFFF;">      [~,removei] = min(wing_angles_curr); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.08 </span></td><td><span style="color: #0000FF">   7503 </span></td><td><span style="color: #20AF20">  4.17k/1.84k/1.16k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 124</span> <span style="color: #000000; background: #FFFFFF;">      area(1) = []; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.06 </span></td><td><span style="color: #0000FF">   7503 </span></td><td><span style="color: #20AF20">    352k/1.56k/528b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 125</span> <span style="color: #000000; background: #FFFFFF;">      wing_angles_curr(removei) = []; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.06 </span></td><td><span style="color: #0000FF">   7503 </span></td><td><span style="color: #20AF20">   1.03k/2.34k/256b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 126</span> <span style="color: #000000; background: #FFFFFF;">      npeaks = 1; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.87 </span></td><td><span style="color: #0000FF">  69744 </span></td><td><span style="color: #20AF20">   28.4k/41.9k/4.2k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 127</span> <span style="color: #000000; background: #FFFFFF;">    elseif area(2) &lt; params.min_single_wing_area, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.07 </span></td><td><span style="color: #0000FF">   3071 </span></td><td><span style="color: #20AF20">     144k/448b/208b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 128</span> <span style="color: #000000; background: #FFFFFF;">      [~,removei] = max(wing_angles_curr); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.03 </span></td><td><span style="color: #0000FF">   3071 </span></td><td><span style="color: #20AF20">  1.39k/3.33k/1.16k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 129</span> <span style="color: #000000; background: #FFFFFF;">      area(2) = []; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.02 </span></td><td><span style="color: #0000FF">   3071 </span></td><td><span style="color: #20AF20">     144k/560b/256b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 130</span> <span style="color: #000000; background: #FFFFFF;">      wing_angles_curr(removei) = []; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.03 </span></td><td><span style="color: #0000FF">   3071 </span></td><td><span style="color: #20AF20">     448b/496b/176b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 131</span> <span style="color: #000000; background: #FFFFFF;">      npeaks = 1; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.01 </span></td><td><span style="color: #0000FF">   3071 </span></td><td><span style="color: #20AF20">     384b/320b/208b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 132</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.32 </span></td><td><span style="color: #0000FF">  77889 </span></td><td><span style="color: #20AF20">   13.9k/14.8k/480b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 133</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   13.9k/14.8k/480b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.59 </span></td><td><span style="color: #0000FF">  86213 </span></td><td><span style="color: #20AF20">  21.1k/18.5k/2.56k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 135</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.96 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">   16.1m/138k/32.1k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 136</span> <span style="color: #000000; background: #FFFFFF;">wing_angles_curr = sort(wing_angles_curr); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.22 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">     161k/69.1k/65k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 137</span> <span style="color: #000000; background: #FFFFFF;">if numel(wing_angles_curr) == 1, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.42 </span></td><td><span style="color: #0000FF"> 253327 </span></td><td><span style="color: #20AF20">    166k/3.9m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 138</span> <span style="color: #000000; background: #FFFFFF;">  if abs(wing_angles_curr) &gt; params.min_nonzero_wing_angle, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.28 </span></td><td><span style="color: #0000FF">  86272 </span></td><td><span style="color: #20AF20">   19.8k/15.3k/1.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 139</span> <span style="color: #000000; background: #FFFFFF;">    wing_trough_angle = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.31 </span></td><td><span style="color: #0000FF">  86272 </span></td><td><span style="color: #20AF20">    4.46m/1.05m/64k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 140</span> <span style="color: #000000; background: #FFFFFF;">    [wing_angles_curr,order] = sort([0,wing_angles_curr]); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.99 </span></td><td><span style="color: #0000FF">  86272 </span></td><td><span style="color: #20AF20">   39.4k/1.23m/4.2k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">    area = [0,area]; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.88 </span></td><td><span style="color: #0000FF">  86272 </span></td><td><span style="color: #20AF20">     502k/150k/438k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">    area = area(order); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.63 </span></td><td><span style="color: #0000FF"> 167055 </span></td><td><span style="color: #20AF20">  37.5k/35.1k/1.34k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 143</span> <span style="color: #228B22; background: #FFFFFF;">  else </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.41 </span></td><td><span style="color: #0000FF"> 167055 </span></td><td><span style="color: #20AF20">      137k/169k/43k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 144</span> <span style="color: #000000; background: #FFFFFF;">    wing_angles_curr = repmat(wing_angles_curr,[1,2]); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.11 </span></td><td><span style="color: #0000FF"> 167055 </span></td><td><span style="color: #20AF20">     222k/90.3k/64k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 145</span> <span style="color: #000000; background: #FFFFFF;">    area = repmat(area,[1,2]); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.71 </span></td><td><span style="color: #0000FF"> 167055 </span></td><td><span style="color: #20AF20">  40.2k/41.3k/4.05k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 146</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.93 </span></td><td><span style="color: #0000FF"> 253327 </span></td><td><span style="color: #20AF20">    84.3k/65.8k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 147</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    84.3k/65.8k/32k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 148</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 16.00 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">   68.9m/1.88m/556k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 149</span> <a name="Line149"></a><span style="color: #000000; background: #FFD4D4;">wingtrx = struct('wing_anglel',[],... </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   68.9m/1.88m/556k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 150</span> <span style="color: #000000; background: #FFD4D4;">  'wing_angler',[],...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   68.9m/1.88m/556k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 151</span> <span style="color: #000000; background: #FFD4D4;">  'nwingsdetected',[],...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   68.9m/1.88m/556k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 152</span> <span style="color: #000000; background: #FFD4D4;">  'wing_areal',[],...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   68.9m/1.88m/556k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 153</span> <span style="color: #000000; background: #FFD4D4;">  'wing_arear',[],...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   68.9m/1.88m/556k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 154</span> <span style="color: #000000; background: #FFD4D4;">  'wing_trough_angle',[]);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   68.9m/1.88m/556k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 155</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.38 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">    14.8m/54.4k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 156</span> <span style="color: #000000; background: #FFFFFF;">wingtrx.wing_anglel = wing_angles_curr(1); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.73 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">   14.7m/43.8k/4.2k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 157</span> <span style="color: #000000; background: #FFFFFF;">wingtrx.wing_angler = wing_angles_curr(2); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.49 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">     14.7m/515k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 158</span> <span style="color: #000000; background: #FFFFFF;">wingtrx.nwingsdetected = npeaks; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.50 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">    14.7m/55.8k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 159</span> <span style="color: #000000; background: #FFFFFF;">wingtrx.wing_areal = area(1); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.58 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">    14.8m/49.1k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 160</span> <span style="color: #000000; background: #FFFFFF;">wingtrx.wing_arear = area(2); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.67 </span></td><td><span style="color: #0000FF"> 320000 </span></td><td><span style="color: #20AF20">       239k/5m/129k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 161</span> <span style="color: #000000; background: #FFFFFF;">wingtrx.wing_trough_angle = wing_trough_angle; </span><br/></pre></td></tr></table></body></html>