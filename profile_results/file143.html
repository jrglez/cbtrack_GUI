<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /><link rel="stylesheet" href="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for kmeans</title><link rel="stylesheet" href="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">kmeans (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/><i>Generated 03-Apr-2014 11:11:21 using cpu time.</i><br/>function in file /Applications/MATLAB_R2013b.app/toolbox/stats/stats/kmeans.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file68.html">mykmeans</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">250</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Allocated Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Freed Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Peak Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line296">296</a></td><td class="td-linebottomrt"><pre>ClusterBest = internal.stats.p...</pre></td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">1.889 s</td><td class="td-linebottomrt">13378.31 Kb</td><td class="td-linebottomrt">13628.30 Kb</td><td class="td-linebottomrt">98.03 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">31.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=31 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line234">234</a></td><td class="td-linebottomrt"><pre>options = statset(statset('kme...</pre></td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">1.211 s</td><td class="td-linebottomrt">2301.45 Kb</td><td class="td-linebottomrt">2110.72 Kb</td><td class="td-linebottomrt">18.23 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">19.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=20 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line254">254</a></td><td class="td-linebottomrt"><pre>[useParallel, RNGscheme, pools...</pre></td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">1.167 s</td><td class="td-linebottomrt">4713.94 Kb</td><td class="td-linebottomrt">3916.95 Kb</td><td class="td-linebottomrt">16.17 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">19.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=19 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line231">231</a></td><td class="td-linebottomrt"><pre>options = statset(options,'Max...</pre></td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">0.744 s</td><td class="td-linebottomrt">95229.52 Kb</td><td class="td-linebottomrt">95165.92 Kb</td><td class="td-linebottomrt">10368.06 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">12.2%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=12 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line228">228</a></td><td class="td-linebottomrt"><pre>options = statset(options,'Dis...</pre></td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">0.233 s</td><td class="td-linebottomrt">22165.55 Kb</td><td class="td-linebottomrt">21890.98 Kb</td><td class="td-linebottomrt">10368.09 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">3.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.856 s</td><td class="td-linebottomrt">55909.39 Kb</td><td class="td-linebottomrt">54583.78 Kb</td><td class="td-linebottomrt">10368.09 Kb</td><td class="td-linebottomrt">14.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=14 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">6.100 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">193698.16 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">191296.66 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">10368.09 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Allocated Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Freed Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Peak Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file147.html">statset</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1000</td><td class="td-linebottomrt">2.161 s</td><td class="td-linebottomrt">119640.23 Kb</td><td class="td-linebottomrt">118777.11 Kb</td><td class="td-linebottomrt">10368.09 Kb</td><td class="td-linebottomrt">35.4%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=35 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file157.html">smartForReduce</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">1.878 s</td><td class="td-linebottomrt">13327.34 Kb</td><td class="td-linebottomrt">13607.30 Kb</td><td class="td-linebottomrt">98.03 Kb</td><td class="td-linebottomrt">30.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=31 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file46.html">processParallelAndStreamOptions</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">1.150 s</td><td class="td-linebottomrt">4647.17 Kb</td><td class="td-linebottomrt">3896.70 Kb</td><td class="td-linebottomrt">16.02 Kb</td><td class="td-linebottomrt">18.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=19 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file145.html">getParamVal</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">750</td><td class="td-linebottomrt">0.411 s</td><td class="td-linebottomrt">42409.55 Kb</td><td class="td-linebottomrt">42285.52 Kb</td><td class="td-linebottomrt">10368.06 Kb</td><td class="td-linebottomrt">6.7%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file144.html">parseArgs</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">0.161 s</td><td class="td-linebottomrt">255.52 Kb</td><td class="td-linebottomrt">10621.38 Kb</td><td class="td-linebottomrt">15.70 Kb</td><td class="td-linebottomrt">2.6%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file141.html">stats/private/statremovenan</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">250</td><td class="td-linebottomrt">0.089 s</td><td class="td-linebottomrt">275.05 Kb</td><td class="td-linebottomrt">191.41 Kb</td><td class="td-linebottomrt">22.56 Kb</td><td class="td-linebottomrt">1.5%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.250 s</td><td class="td-linebottomrt">13143.30 Kb</td><td class="td-linebottomrt">1917.25 Kb</td><td class="td-linebottomrt">10368.09 Kb</td><td class="td-linebottomrt">4.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">6.100 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">193698.16 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">191296.66 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">10368.09 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line655">655</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'prevtotsumD' might be unused.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">748</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">618</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">130</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">58</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">72</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">44.62 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table border = "0" cellpadding = "1" cellspacing = "5"><style> td,th { text-align:center; } .leftAligned{ text-align:left; }</style><tr><th><span style="color: #FF0000; font-weight: bold; text-decoration: none">time</span> </th><th><span style="color: #0000FF; font-weight: bold; text-decoration: none">calls</span> </th><th><span style="color: #20AF20; font-weight: bold; text-decoration: none">mem</span> </th><th class="leftAligned"><span style="font-weight: bold; text-decoration: none">  line</span></th></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [idxbest, Cbest, sumDbest, Dbest] = kmeans(X, k, varargin)</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%KMEANS K-means clustering.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%   IDX = KMEANS(X, K) partitions the points in the N-by-P data matrix X</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   into K clusters.  This partition minimizes the sum, over all clusters, of</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%   the within-cluster sums of point-to-cluster-centroid distances.  Rows of X</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%   correspond to points, columns correspond to variables.  Note: when X is a</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%   vector, KMEANS treats it as an N-by-1 data matrix, regardless of its</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%   orientation.  KMEANS returns an N-by-1 vector IDX containing the cluster</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%   indices of each point.  By default, KMEANS uses squared Euclidean</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%   distances.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%   KMEANS treats NaNs as missing data, and ignores any rows of X that</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%   contain NaNs.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%   [IDX, C] = KMEANS(X, K) returns the K cluster centroid locations in</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">%   the K-by-P matrix C.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%   [IDX, C, SUMD] = KMEANS(X, K) returns the within-cluster sums of</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%   point-to-centroid distances in the 1-by-K vector sumD.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%   [IDX, C, SUMD, D] = KMEANS(X, K) returns distances from each point</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%   to every centroid in the N-by-K matrix D.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%   [ ... ] = KMEANS(..., 'PARAM1',val1, 'PARAM2',val2, ...) specifies</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%   optional parameter name/value pairs to control the iterative algorithm</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%   used by KMEANS.  Parameters are:</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%   'Distance' - Distance measure, in P-dimensional space, that KMEANS</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%      should minimize with respect to.  Choices are:</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%          'sqEuclidean'  - Squared Euclidean distance (the default)</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%          'cityblock'    - Sum of absolute differences, a.k.a. L1 distance</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%          'cosine'       - One minus the cosine of the included angle</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%                           between points (treated as vectors)</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%          'correlation'  - One minus the sample correlation between points</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%                           (treated as sequences of values)</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%          'Hamming'      - Percentage of bits that differ (only suitable</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%                           for binary data)</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%   'Start' - Method used to choose initial cluster centroid positions,</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%      sometimes known as "seeds".  Choices are:</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%          'sample'  - Select K observations from X at random (the default)</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%          'uniform' - Select K points uniformly at random from the range</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%                      of X.  Not valid for Hamming distance.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%          'cluster' - Perform preliminary clustering phase on random 10%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%                      subsample of X.  This preliminary phase is itself</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%                      initialized using 'sample'.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%           matrix   - A K-by-P matrix of starting locations.  In this case,</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%                      you can pass in [] for K, and KMEANS infers K from</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%                      the first dimension of the matrix.  You can also</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%                      supply a 3D array, implying a value for 'Replicates'</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%                      from the array's third dimension.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%   'Replicates' - Number of times to repeat the clustering, each with a</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%      new set of initial centroids.  A positive integer, default is 1.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%   'EmptyAction' - Action to take if a cluster loses all of its member</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%      observations.  Choices are:</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">%          'error'     - Treat an empty cluster as an error (the default)</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%          'drop'      - Remove any clusters that become empty, and set</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">%                        the corresponding values in C and D to NaN.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">%          'singleton' - Create a new cluster consisting of the one</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%                        observation furthest from its centroid.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%   'Options' - Options for the iterative algorithm used to minimize the</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">%       fitting criterion, as created by STATSET.  Choices of STATSET</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">%       parameters are:</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;">%          'Display'  - Level of display output.  Choices are 'off', (the</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">%                       default), 'iter', and 'final'.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">%          'MaxIter'  - Maximum number of iterations allowed.  Default is 100.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;">%          'UseParallel'</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;">%          'UseSubstreams'</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">%          'Streams'  - These fields specify whether to perform clustering</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;">%                       from multiple 'Start' values in parallel, and how</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF;">%                       to use random numbers when generating the starting</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;">%                       points. For information on these fields see</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;">%                       PARALLELSTATS.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">%                       NOTE: If 'UseParallel' is TRUE and 'UseSubstreams' is FALSE,</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">%                       then the length of 'Streams' must equal the number of workers </span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;">%                       used by KMEANS.  If a parallel pool is already open, this </span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF;">%                       will be the size of the parallel pool.  If a parallel pool </span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF;">%                       is not already open, then MATLAB may try to open a pool for </span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  84</span> <span style="color: #228B22; background: #FFFFFF;">%                       you (depending on your installation and preferences).</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  85</span> <span style="color: #228B22; background: #FFFFFF;">%                       To ensure more predictable results, it is best to use </span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF;">%                       the PARPOOL command and explicitly create a parallel pool </span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF;">%                       prior to invoking KMEANS with 'UseParallel' set to TRUE. </span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  89</span> <span style="color: #228B22; background: #FFFFFF;">%   'OnlinePhase' - Flag indicating whether KMEANS should perform an "on-line</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF;">%      update" phase in addition to a "batch update" phase.  The on-line phase</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  91</span> <span style="color: #228B22; background: #FFFFFF;">%      can be time consuming for large data sets, but guarantees a solution</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;">%      that is a local minimum of the distance criterion, i.e., a partition of</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;">%      the data where moving any single point to a different cluster increases</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">%      the total sum of distances.  'on' (the default) or 'off'.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  96</span> <span style="color: #228B22; background: #FFFFFF;">%   Example:</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;">%       X = [randn(20,2)+ones(20,2); randn(20,2)-ones(20,2)];</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;">%       opts = statset('Display','final');</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF;">%       [cidx, ctrs] = kmeans(X, 2, 'Distance','city', ...</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;">%                             'Replicates',5, 'Options',opts);</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF;">%       plot(X(cidx==1,1),X(cidx==1,2),'r.', ...</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF;">%            X(cidx==2,1),X(cidx==2,2),'b.', ctrs(:,1),ctrs(:,2),'kx');</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;">%   See also LINKAGE, CLUSTERDATA, SILHOUETTE.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF;">%   KMEANS uses a two-phase iterative algorithm to minimize the sum of</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;">%   point-to-centroid distances, summed over all K clusters.  The first phase</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 109</span> <span style="color: #228B22; background: #FFFFFF;">%   uses what the literature often describes as "batch" updates, where each</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;">%   iteration consists of reassigning points to their nearest cluster</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;">%   centroid, all at once, followed by recalculation of cluster centroids.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF;">%   This phase occasionally (especially for small data sets) does not converge</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF;">%   to solution that is a local minimum, i.e., a partition of the data where</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 114</span> <span style="color: #228B22; background: #FFFFFF;">%   moving any single point to a different cluster increases the total sum of</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF;">%   distances.  Thus, the batch phase be thought of as providing a fast but</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF;">%   potentially only approximate solution as a starting point for the second</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 117</span> <span style="color: #228B22; background: #FFFFFF;">%   phase.  The second phase uses what the literature often describes as</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF;">%   "on-line" updates, where points are individually reassigned if doing so</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;">%   will reduce the sum of distances, and cluster centroids are recomputed</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 120</span> <span style="color: #228B22; background: #FFFFFF;">%   after each reassignment.  Each iteration during this second phase consists</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;">%   of one pass though all the points.  The on-line phase will converge to a</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;">%   local minimum, although there may be other local minima with lower total</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 123</span> <span style="color: #228B22; background: #FFFFFF;">%   sum of distances.  The problem of finding the global minimum can only be</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;">%   solved in general by an exhaustive (or clever, or lucky) choice of</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF;">%   starting points, but using several replicates with random starting points</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 126</span> <span style="color: #228B22; background: #FFFFFF;">%   typically results in a solution that is a global minimum.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 127</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 128</span> <span style="color: #228B22; background: #FFFFFF;">% References:</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 129</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 130</span> <span style="color: #228B22; background: #FFFFFF;">%   [1] Seber, G.A.F. (1984) Multivariate Observations, Wiley, New York.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 131</span> <span style="color: #228B22; background: #FFFFFF;">%   [2] Spath, H. (1985) Cluster Dissection and Analysis: Theory, FORTRAN</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 132</span> <span style="color: #228B22; background: #FFFFFF;">%       Programs, Examples, translated by J. Goldschmidt, Halsted Press,</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF;">%       New York.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 135</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright 1993-2013 The MathWorks, Inc.</span><br/></pre></td></tr><tr><td></td><td></td><td> (250 calls, 6.100 sec, 193698.16 Kb, 191296.66 Kb, 10368.09 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 136</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">         64b/0b/64b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 137</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 2 </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         64b/0b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 138</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('stats:kmeans:TooFewInputs'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         64b/0b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 139</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         64b/0b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 140</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.09 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">    277k/200k/22.6k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">[~,wasnan,X] = <a href="file141.html">statremovenan</a>(X); </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       208b/0b/128b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">hadNaNs = any(wasnan); </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       512b/0b/352b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 143</span> <span style="color: #000000; background: #FFFFFF;">if hadNaNs </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       512b/0b/352b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 144</span> <span style="color: #A0A0A0; background: #FFFFFF;">    warning(message('stats:kmeans:MissingDataRemoved'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       512b/0b/352b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 145</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       512b/0b/352b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       512b/0b/352b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 147</span> <span style="color: #228B22; background: #FFFFFF;">% n points in p dimensional space</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       64b/240b/64b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 148</span> <span style="color: #000000; background: #FFFFFF;">[n, p] = size(X); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       64b/240b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">      144b/112b/96b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 150</span> <span style="color: #000000; background: #FFFFFF;">pnames = {   'distance'  'start' 'replicates' 'emptyaction' 'onlinephase' 'options' 'maxiter' 'display'}; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">     34.9k/96b/192b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">dflts =  {'sqeuclidean' 'sample'          []         'error'         'on'        []        []        []}; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.18 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">  10.5m/10.4m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 152</span> <span style="color: #000000; background: #FFFFFF;">[distance,start,reps,emptyact,online,options,maxit,display] ... </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  10.5m/10.4m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 153</span> <span style="color: #000000; background: #FFFFFF;">    = internal.stats.parseArgs(pnames, dflts, varargin{:});</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  10.5m/10.4m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 154</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">     2.02k/0b/1.88k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 155</span> <span style="color: #000000; background: #FFFFFF;">distNames = {'sqeuclidean','cityblock','cosine','correlation','hamming'}; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">  20.6m/20.6m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 156</span> <span style="color: #000000; background: #FFFFFF;">distance = internal.stats.<a href="file145.html">getParamVal</a>(distance,distNames,'''Distance'''); </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       80b/192b/80b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 157</span> <span style="color: #000000; background: #FFFFFF;">switch distance </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">      256b/96b/256b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 158</span> <span style="color: #000000; background: #FFFFFF;">    case 'cosine' </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      256b/96b/256b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 159</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Xnorm = sqrt(sum(X.^2, 2));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      256b/96b/256b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 160</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if any(min(Xnorm) &lt;= eps(max(Xnorm)))</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      256b/96b/256b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 161</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:kmeans:ZeroDataForCos'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      256b/96b/256b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 162</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      256b/96b/256b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 163</span> <span style="color: #A0A0A0; background: #FFFFFF;">        X = X ./ Xnorm(:,ones(1,p));</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       64b/224b/64b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 164</span> <span style="color: #000000; background: #FFFFFF;">    case 'correlation' </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       64b/224b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 165</span> <span style="color: #A0A0A0; background: #FFFFFF;">        X = bsxfun(@minus, X, mean(X,2));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       64b/224b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 166</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Xnorm = sqrt(sum(X.^2, 2));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       64b/224b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 167</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if any(min(Xnorm) &lt;= eps(max(Xnorm)))</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       64b/224b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 168</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:kmeans:ConstantDataForCorr'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       64b/224b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 169</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       64b/224b/64b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 170</span> <span style="color: #A0A0A0; background: #FFFFFF;">        X = X ./ Xnorm(:,ones(1,p));</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">      128b/80b/112b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 171</span> <span style="color: #000000; background: #FFFFFF;">    case 'hamming' </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      128b/80b/112b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 172</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~all(ismember(X(:),[0 1]))</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      128b/80b/112b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 173</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:kmeans:NonbinaryDataForHamm'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      128b/80b/112b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 174</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      128b/80b/112b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 175</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      128b/80b/112b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 176</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 177</span> <span style="color: #000000; background: #FFFFFF;">if ischar(start) </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 178</span> <span style="color: #A0A0A0; background: #FFFFFF;">    startNames = {'uniform','sample','cluster'};</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 179</span> <span style="color: #A0A0A0; background: #FFFFFF;">    j = find(strncmpi(start,startNames,length(start)));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 180</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if length(j) &gt; 1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 181</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:kmeans:AmbiguousStart', start));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 182</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif isempty(j)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 183</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:kmeans:UnknownStart', start));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 184</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif isempty(k)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 185</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:kmeans:MissingK'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 186</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 187</span> <span style="color: #A0A0A0; background: #FFFFFF;">    start = startNames{j};</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 188</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if strcmp(start, 'uniform')</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 189</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if strcmp(distance, 'hamming')</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 190</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:kmeans:UniformStartForHamm'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 191</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 192</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Xmins = min(X,[],1);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 193</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Xmaxs = max(X,[],1);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    17.1k/3.78k/16k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 194</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">   3.06k/160b/2.31k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 195</span> <span style="color: #000000; background: #FFFFFF;">elseif isnumeric(start) </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">     13.1k/624b/13k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 196</span> <span style="color: #000000; background: #FFFFFF;">    CC = start; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">      176b/112b/96b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 197</span> <span style="color: #000000; background: #FFFFFF;">    start = 'numeric'; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">     416b/256b/336b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 198</span> <span style="color: #000000; background: #FFFFFF;">    if isempty(k) </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     416b/256b/336b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 199</span> <span style="color: #A0A0A0; background: #FFFFFF;">        k = size(CC,1);</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">          0b/96b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 200</span> <span style="color: #000000; background: #FFFFFF;">    elseif k ~= size(CC,1); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/96b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 201</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:kmeans:StartBadRowSize'));</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       368b/0b/352b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 202</span> <span style="color: #000000; background: #FFFFFF;">    elseif size(CC,2) ~= p </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       368b/0b/352b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 203</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:kmeans:StartBadColumnSize'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       368b/0b/352b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 204</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       864b/0b/768b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 205</span> <span style="color: #000000; background: #FFFFFF;">    if isempty(reps) </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">       864b/0b/768b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 206</span> <span style="color: #A0A0A0; background: #FFFFFF;">        reps = size(CC,3);</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">         0b/416b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 207</span> <span style="color: #000000; background: #FFFFFF;">    elseif reps ~= size(CC,3); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/416b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 208</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:kmeans:StartBadThirdDimSize'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/416b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 209</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/416b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 210</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/416b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 211</span> <span style="color: #228B22; background: #FFFFFF;">    % Need to center explicit starting points for 'correlation'. (Re)normalization</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/416b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 212</span> <span style="color: #228B22; background: #FFFFFF;">    % for 'cosine'/'correlation' is done at each iteration.</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">    11.6k/12.1k/48b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 213</span> <span style="color: #000000; background: #FFFFFF;">    if isequal(distance, 'correlation') </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    11.6k/12.1k/48b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 214</span> <span style="color: #A0A0A0; background: #FFFFFF;">          CC = bsxfun(@minus, CC, mean(CC,2));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    11.6k/12.1k/48b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 215</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    11.6k/12.1k/48b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 216</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    11.6k/12.1k/48b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 217</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('stats:kmeans:InvalidStart'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    11.6k/12.1k/48b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 218</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    11.6k/12.1k/48b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       64b/416b/64b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 220</span> <span style="color: #000000; background: #FFFFFF;">emptyactNames = {'error','drop','singleton'}; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.13 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">  20.6m/20.5m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 221</span> <span style="color: #000000; background: #FFFFFF;">emptyact = internal.stats.<a href="file145.html">getParamVal</a>(emptyact,emptyactNames,'''EmptyAction'''); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  20.6m/20.5m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 222</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.14 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">    269k/264k/3.86k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 223</span> <span style="color: #000000; background: #FFFFFF;">[~,online] = internal.stats.<a href="file145.html">getParamVal</a>(online,{'on','off'},'''OnlinePhase'''); </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">    336b/3.92k/112b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 224</span> <span style="color: #000000; background: #FFFFFF;">online = (online==1); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    336b/3.92k/112b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 225</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    336b/3.92k/112b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 226</span> <span style="color: #228B22; background: #FFFFFF;">% 'maxiter' and 'display' are grandfathered as separate param name/value pairs</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">     208b/288b/112b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 227</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(display) </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.23 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">  21.6m/21.4m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 228</span> <a name="Line228"></a><span style="color: #000000; background: #FFF0F0;">    options = <a href="file147.html">statset</a>(options,'Display',display); </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">   2.69k/304b/2.47k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 229</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">     8.67k/32b/896b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 230</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(maxit) </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.74 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">    93m/92.9m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 231</span> <a name="Line231"></a><span style="color: #000000; background: #FFD4D4;">    options = <a href="file147.html">statset</a>(options,'MaxIter',maxit); </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">    93m/92.9m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 232</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    93m/92.9m/10.1m </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 233</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.21 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">  2.25m/2.06m/18.2k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 234</span> <a name="Line234"></a><span style="color: #000000; background: #FFAAAA;">options = <a href="file147.html">statset</a>(<a href="file147.html">statset</a>('kmeans'), options); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">   3.81k/18.5k/144b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 235</span> <span style="color: #000000; background: #FFFFFF;">display = find(strncmpi(options.Display, {'off','notify','final','iter'},... </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   3.81k/18.5k/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 236</span> <span style="color: #000000; background: #FFFFFF;">    length(options.Display))) - 1;</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">          0b/64b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 237</span> <span style="color: #000000; background: #FFFFFF;">maxit = options.MaxIter; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/64b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 238</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">          0b/64b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 239</span> <span style="color: #000000; background: #FFFFFF;">if ~(isscalar(k) &amp;&amp; isnumeric(k) &amp;&amp; isreal(k) &amp;&amp; k &gt; 0 &amp;&amp; (round(k)==k)) </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/64b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 240</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('stats:kmeans:InvalidK'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/64b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 241</span> <span style="color: #228B22; background: #FFFFFF;">    % elseif k == 1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/64b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 242</span> <span style="color: #228B22; background: #FFFFFF;">    % this special case works automatically</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">          0b/32b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 243</span> <span style="color: #000000; background: #FFFFFF;">elseif n &lt; k </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/32b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 244</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('stats:kmeans:TooManyClusters'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/32b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 245</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/32b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 246</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/32b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 247</span> <span style="color: #228B22; background: #FFFFFF;">% Assume one replicate</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">         48b/0b/32b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 248</span> <span style="color: #000000; background: #FFFFFF;">if isempty(reps) </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         48b/0b/32b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 249</span> <span style="color: #A0A0A0; background: #FFFFFF;">    reps = 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         48b/0b/32b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 250</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         48b/0b/32b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 251</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">        0b/16.4k/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 252</span> <span style="color: #000000; background: #FFFFFF;">emptyErrCnt = 0; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">        0b/16.4k/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 253</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.17 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">   4.6m/3.83m/16.2k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 254</span> <a name="Line254"></a><span style="color: #000000; background: #FFAAAA;">[useParallel, RNGscheme, poolsz] = ... </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   4.6m/3.83m/16.2k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 255</span> <span style="color: #000000; background: #FFAAAA;">    internal.stats.parallel.processParallelAndStreamOptions(options,true);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   4.6m/3.83m/16.2k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 256</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">   4.6m/3.83m/16.2k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 257</span> <span style="color: #000000; background: #FFFFFF;">usePool = useParallel &amp;&amp; poolsz&gt;0; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   4.6m/3.83m/16.2k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   4.6m/3.83m/16.2k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF;">% Define the function that will perform one iteration of the</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   4.6m/3.83m/16.2k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 260</span> <span style="color: #228B22; background: #FFFFFF;">% loop inside smartFor</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">      75.1k/0b/336b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 261</span> <span style="color: #000000; background: #FFFFFF;">loopbody = @loopBody; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      75.1k/0b/336b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 262</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      75.1k/0b/336b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF;">% Initialize nested variables so they will not appear to be functions here</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">      75.1k/0b/336b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 264</span> <span style="color: #000000; background: #FFFFFF;">totsumD = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">      75.1k/0b/336b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 265</span> <span style="color: #000000; background: #FFFFFF;">iter = 0; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      75.1k/0b/336b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 266</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      75.1k/0b/336b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF;">% Prepare for in-progress</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 268</span> <span style="color: #000000; background: #FFFFFF;">if display &gt; 1 % 'iter' or 'final' </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 269</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if usePool</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 270</span> <span style="color: #228B22; background: #FFFFFF;">        % If we are running on a matlabpool, each worker will generate</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 271</span> <span style="color: #228B22; background: #FFFFFF;">        % a separate periodic report.  Before starting the loop, we</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 272</span> <span style="color: #228B22; background: #FFFFFF;">        % seed the matlabpool so that each worker will have an</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF;">        % identifying label (eg, index) for its report.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 274</span> <span style="color: #A0A0A0; background: #FFFFFF;">        internal.stats.parallel.distributeToPool( ...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 275</span> <span style="color: #A0A0A0; background: #FFFFFF;">            'workerID', num2cell(1:poolsz) );</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 276</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 277</span> <span style="color: #228B22; background: #FFFFFF;">        % Periodic reports behave differently in parallel than they do</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">        % in serial computation (which is the baseline).</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 279</span> <span style="color: #228B22; background: #FFFFFF;">        % We advise the user of the difference.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 280</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 281</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if display == 3 % 'iter' only</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 282</span> <span style="color: #A0A0A0; background: #FFFFFF;">            warning(message('stats:kmeans:displayParallel2'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 283</span> <span style="color: #A0A0A0; background: #FFFFFF;">            fprintf('    worker\t  iter\t phase\t     num\t         sum\n' );</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 284</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 285</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 286</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if useParallel</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 287</span> <span style="color: #A0A0A0; background: #FFFFFF;">            warning(message('stats:kmeans:displayParallel'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 288</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 289</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if display == 3 % 'iter' only</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 290</span> <span style="color: #A0A0A0; background: #FFFFFF;">            fprintf('  iter\t phase\t     num\t         sum\n');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 291</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 292</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 293</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 294</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      35.2k/0b/144b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 295</span> <span style="color: #228B22; background: #FFFFFF;">% Perform KMEANS replicates on separate workers.</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.89 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">    13.1m/13.3m/98k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 296</span> <a name="Line296"></a><span style="color: #000000; background: #FF8080;">ClusterBest = internal.stats.parallel.<a href="file157.html">smartForReduce</a>(... </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    13.1m/13.3m/98k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 297</span> <span style="color: #000000; background: #FF8080;">    reps, loopbody, useParallel, RNGscheme, 'argmin');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    13.1m/13.3m/98k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 298</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    13.1m/13.3m/98k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 299</span> <span style="color: #228B22; background: #FFFFFF;">% Extract the best solution</span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">     288b/320b/288b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 300</span> <span style="color: #000000; background: #FFFFFF;">idxbest = ClusterBest{5}; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       64b/112b/64b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 301</span> <span style="color: #000000; background: #FFFFFF;">Cbest = ClusterBest{6}; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       416b/0b/384b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 302</span> <span style="color: #000000; background: #FFFFFF;">sumDbest = ClusterBest{3}; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">         0b/304b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 303</span> <span style="color: #000000; background: #FFFFFF;">totsumDbest = ClusterBest{1}; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">         0b/128b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 304</span> <span style="color: #000000; background: #FFFFFF;">if nargout &gt; 3 </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">       304b/0b/272b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 305</span> <span style="color: #000000; background: #FFFFFF;">    Dbest = ClusterBest{7}; </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">         0b/256b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 306</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/256b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 307</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">         0b/256b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 308</span> <span style="color: #000000; background: #FFFFFF;">if display &gt; 1 % 'final' or 'iter' </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/256b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 309</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fprintf('%s\n',getString(message('stats:kmeans:FinalSumOfDistances',sprintf('%g',totsumDbest))));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/256b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 310</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">         0b/256b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 311</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 312</span> <span style="color: #000000; background: #FFFFFF;">if hadNaNs </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 313</span> <span style="color: #A0A0A0; background: #FFFFFF;">    idxbest = statinsertnan(wasnan, idxbest);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 314</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 315</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 316</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function cellout = loopBody(rep,S)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 317</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 318</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(S)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 319</span> <span style="color: #A0A0A0; background: #FFFFFF;">            S = RandStream.getGlobalStream;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 320</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 321</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 322</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if display &gt; 1 % 'iter'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 323</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if usePool</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 324</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dispfmt = '%8d\t%6d\t%6d\t%8d\t%12g\n';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 325</span> <span style="color: #A0A0A0; background: #FFFFFF;">                labindx = internal.stats.parallel.workerGetValue('workerID');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 326</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 327</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dispfmt = '%6d\t%6d\t%8d\t%12g\n';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 328</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 329</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 330</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 331</span> <span style="color: #A0A0A0; background: #FFFFFF;">        cellout = cell(7,1);  % cellout{1} = total sum of distances</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 332</span> <span style="color: #228B22; background: #FFFFFF;">                              % cellout{2} = replicate number</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 333</span> <span style="color: #228B22; background: #FFFFFF;">                              % cellout{3} = sum of distance for each cluster</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 334</span> <span style="color: #228B22; background: #FFFFFF;">                              % cellout{4} = iteration</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF;">                              % cellout{5} = idx;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 336</span> <span style="color: #228B22; background: #FFFFFF;">                              % cellout{6} = Center</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 337</span> <span style="color: #228B22; background: #FFFFFF;">                              % cellout{7} = Distance</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 338</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 339</span> <span style="color: #228B22; background: #FFFFFF;">        % Populating total sum of distances to Inf. This is used in the</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 340</span> <span style="color: #228B22; background: #FFFFFF;">        % reduce operation if update fails due to empty cluster.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 341</span> <span style="color: #A0A0A0; background: #FFFFFF;">        cellout{1} = Inf;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 342</span> <span style="color: #A0A0A0; background: #FFFFFF;">        cellout{2} = rep;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 343</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 344</span> <span style="color: #A0A0A0; background: #FFFFFF;">        switch start</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 345</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'uniform'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 346</span> <span style="color: #A0A0A0; background: #FFFFFF;">                C = Xmins(ones(k,1),:) + rand(S,[k,p]).*(Xmaxs(ones(k,1),:)-Xmins(ones(k,1),:));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 347</span> <span style="color: #228B22; background: #FFFFFF;">                % For 'cosine' and 'correlation', these are uniform inside a subset</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 348</span> <span style="color: #228B22; background: #FFFFFF;">                % of the unit hypersphere.  Still need to center them for</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 349</span> <span style="color: #228B22; background: #FFFFFF;">                % 'correlation'.  (Re)normalization for 'cosine'/'correlation' is</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 350</span> <span style="color: #228B22; background: #FFFFFF;">                % done at each iteration.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 351</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isequal(distance, 'correlation')</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 352</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    C = bsxfun(@minus, C, mean(C,2));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 353</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 354</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isa(X,'single')</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 355</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    C = single(C);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 356</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 357</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'sample'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 358</span> <span style="color: #A0A0A0; background: #FFFFFF;">                C = X(randsample(S,n,k),:);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 359</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isfloat(C)      % X may be logical</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 360</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    C = double(C);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 361</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 362</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'cluster'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 363</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Xsubset = X(randsample(S,n,floor(.1*n)),:);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 364</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [~, C] = kmeans(Xsubset, k, varargin{:}, 'start','sample', 'replicates',1);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 365</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'numeric'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 366</span> <span style="color: #A0A0A0; background: #FFFFFF;">                C = CC(:,:,rep);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 367</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 368</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 369</span> <span style="color: #228B22; background: #FFFFFF;">        % Compute the distance from every point to each cluster centroid and the</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 370</span> <span style="color: #228B22; background: #FFFFFF;">        % initial assignment of points to clusters</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 371</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = distfun(X, C, distance, 0, rep, reps);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 372</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [d, idx] = min(D, [], 2);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 373</span> <span style="color: #A0A0A0; background: #FFFFFF;">        m = accumarray(idx,1,[k,1]);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 374</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 375</span> <span style="color: #A0A0A0; background: #FFFFFF;">        try % catch empty cluster errors and move on to next rep</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 376</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 377</span> <span style="color: #228B22; background: #FFFFFF;">            % Begin phase one:  batch reassignments</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 378</span> <span style="color: #A0A0A0; background: #FFFFFF;">            converged = batchUpdate();</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 379</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 380</span> <span style="color: #228B22; background: #FFFFFF;">            % Begin phase two:  single reassignments</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 381</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if online</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 382</span> <span style="color: #A0A0A0; background: #FFFFFF;">                converged = onlineUpdate();</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 383</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 384</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 385</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 386</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if display == 2 % 'final'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 387</span> <span style="color: #A0A0A0; background: #FFFFFF;">                fprintf('%s\n',getString(message('stats:kmeans:IterationsSumOfDistances',rep,iter,sprintf('%g',totsumD) )));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 388</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 389</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 390</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~converged</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 391</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if reps==1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 392</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning(message('stats:kmeans:FailedToConverge', maxit));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 393</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 394</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning(message('stats:kmeans:FailedToConvergeRep', maxit, rep));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 395</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 396</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 397</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 398</span> <span style="color: #228B22; background: #FFFFFF;">            % Calculate cluster-wise sums of distances</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 399</span> <span style="color: #A0A0A0; background: #FFFFFF;">            nonempties = find(m&gt;0);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 400</span> <span style="color: #A0A0A0; background: #FFFFFF;">            D(:,nonempties) = distfun(X, C(nonempties,:), distance, iter, rep, reps);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 401</span> <span style="color: #A0A0A0; background: #FFFFFF;">            d = D((idx-1)*n + (1:n)');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 402</span> <span style="color: #A0A0A0; background: #FFFFFF;">            sumD = accumarray(idx,d,[k,1]);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 403</span> <span style="color: #A0A0A0; background: #FFFFFF;">            totsumD = sum(sumD(nonempties));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 404</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 405</span> <span style="color: #228B22; background: #FFFFFF;">            % Save the best solution so far</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 406</span> <span style="color: #A0A0A0; background: #FFFFFF;">             cellout = {totsumD,rep,sumD,iter,idx,C,D}';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 407</span> <span style="color: #228B22; background: #FFFFFF;">           </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 408</span> <span style="color: #228B22; background: #FFFFFF;">            % If an empty cluster error occurred in one of multiple replicates, catch</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 409</span> <span style="color: #228B22; background: #FFFFFF;">            % it, warn, and move on to next replicate.  Error only when all replicates</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 410</span> <span style="color: #228B22; background: #FFFFFF;">            % fail.  Rethrow an other kind of error.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 411</span> <span style="color: #A0A0A0; background: #FFFFFF;">        catch ME</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 412</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if reps == 1 || (~isequal(ME.identifier,'stats:kmeans:EmptyCluster')  &amp;&amp; ...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 413</span> <span style="color: #A0A0A0; background: #FFFFFF;">                         ~isequal(ME.identifier,'stats:kmeans:EmptyClusterRep'))</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 414</span> <span style="color: #A0A0A0; background: #FFFFFF;">                rethrow(ME);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 415</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 416</span> <span style="color: #A0A0A0; background: #FFFFFF;">                emptyErrCnt = emptyErrCnt + 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 417</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning(message('stats:kmeans:EmptyClusterInBatchUpdate', rep, iter));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 418</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if emptyErrCnt == reps</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 419</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error(message('stats:kmeans:EmptyClusterAllReps'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 420</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 421</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 422</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % catch</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 423</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 424</span> <span style="color: #228B22; background: #FFFFFF;">        %------------------------------------------------------------------</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 425</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 426</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function converged = batchUpdate()</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 427</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 428</span> <span style="color: #228B22; background: #FFFFFF;">            % Every point moved, every cluster will need an update</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 429</span> <span style="color: #A0A0A0; background: #FFFFFF;">            moved = 1:n;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 430</span> <span style="color: #A0A0A0; background: #FFFFFF;">            changed = 1:k;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 431</span> <span style="color: #A0A0A0; background: #FFFFFF;">            previdx = zeros(n,1);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 432</span> <span style="color: #A0A0A0; background: #FFFFFF;">            prevtotsumD = Inf;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 433</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 434</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 435</span> <span style="color: #228B22; background: #FFFFFF;">            % Begin phase one:  batch reassignments</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 436</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 437</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 438</span> <span style="color: #A0A0A0; background: #FFFFFF;">            iter = 0;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 439</span> <span style="color: #A0A0A0; background: #FFFFFF;">            converged = false;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 440</span> <span style="color: #A0A0A0; background: #FFFFFF;">            while true</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 441</span> <span style="color: #A0A0A0; background: #FFFFFF;">                iter = iter + 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 442</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 443</span> <span style="color: #228B22; background: #FFFFFF;">                % Calculate the new cluster centroids and counts, and update the</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 444</span> <span style="color: #228B22; background: #FFFFFF;">                % distance from every point to those new cluster centroids</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 445</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [C(changed,:), m(changed)] = gcentroids(X, idx, changed, distance);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 446</span> <span style="color: #A0A0A0; background: #FFFFFF;">                D(:,changed) = distfun(X, C(changed,:), distance, iter, rep, reps);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 447</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 448</span> <span style="color: #228B22; background: #FFFFFF;">                % Deal with clusters that have just lost all their members</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 449</span> <span style="color: #A0A0A0; background: #FFFFFF;">                empties = changed(m(changed) == 0);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 450</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(empties)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 451</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if strcmp(emptyact,'error')</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 452</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if reps==1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 453</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            error(message('stats:kmeans:EmptyCluster', iter));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 454</span> <span style="color: #228B22; background: #FFFFFF;">                        else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 455</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            error(message('stats:kmeans:EmptyClusterRep', iter, rep));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 456</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 457</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 458</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if reps==1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 459</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        warning(message('stats:kmeans:EmptyCluster', iter));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 460</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 461</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        warning(message('stats:kmeans:EmptyClusterRep', iter, rep));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 462</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 463</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    switch emptyact</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 464</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        case 'drop'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 465</span> <span style="color: #228B22; background: #FFFFFF;">                            % Remove the empty cluster from any further processing</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 466</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            D(:,empties) = NaN;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 467</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            changed = changed(m(changed) &gt; 0);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 468</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        case 'singleton'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 469</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            for i = empties</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 470</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                d = D((idx-1)*n + (1:n)'); % use newly updated distances</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 471</span> <span style="color: #228B22; background: #FFFFFF;">                                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 472</span> <span style="color: #228B22; background: #FFFFFF;">                                % Find the point furthest away from its current cluster.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 473</span> <span style="color: #228B22; background: #FFFFFF;">                                % Take that point out of its cluster and use it to create</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 474</span> <span style="color: #228B22; background: #FFFFFF;">                                % a new singleton cluster to replace the empty one.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 475</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                [~, lonely] = max(d);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 476</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                from = idx(lonely); % taking from this cluster</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 477</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                if m(from) &lt; 2</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 478</span> <span style="color: #228B22; background: #FFFFFF;">                                    % In the very unusual event that the cluster had only</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 479</span> <span style="color: #228B22; background: #FFFFFF;">                                    % one member, pick any other non-singleton point.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 480</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                    from = find(m&gt;1,1,'first');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 481</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                    lonely = find(idx==from,1,'first');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 482</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 483</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                C(i,:) = X(lonely,:);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 484</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                m(i) = 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 485</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                idx(lonely) = i;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 486</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                D(:,i) = distfun(X, C(i,:), distance, iter, rep, reps);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 487</span> <span style="color: #228B22; background: #FFFFFF;">                                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 488</span> <span style="color: #228B22; background: #FFFFFF;">                                % Update clusters from which points are taken</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 489</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                [C(from,:), m(from)] = gcentroids(X, idx, from, distance);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 490</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                D(:,from) = distfun(X, C(from,:), distance, iter, rep, reps);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 491</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                changed = unique([changed from]);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 492</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 493</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 494</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 495</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 496</span> <span style="color: #228B22; background: #FFFFFF;">                % Compute the total sum of distances for the current configuration.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 497</span> <span style="color: #A0A0A0; background: #FFFFFF;">                totsumD = sum(D((idx-1)*n + (1:n)'));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 498</span> <span style="color: #228B22; background: #FFFFFF;">                % Test for a cycle: if objective is not decreased, back out</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 499</span> <span style="color: #228B22; background: #FFFFFF;">                % the last step and move on to the single update phase</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 500</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if prevtotsumD &lt;= totsumD</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 501</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    idx = previdx;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 502</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [C(changed,:), m(changed)] = gcentroids(X, idx, changed, distance);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 503</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    iter = iter - 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 504</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    break;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 505</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 506</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if display &gt; 2 % 'iter'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 507</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if usePool</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 508</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        fprintf(dispfmt,labindx,iter,1,length(moved),totsumD);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 509</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 510</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        fprintf(dispfmt,iter,1,length(moved),totsumD);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 511</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 512</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 513</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if iter &gt;= maxit</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 514</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    break;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 515</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 516</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 517</span> <span style="color: #228B22; background: #FFFFFF;">                % Determine closest cluster for each point and reassign points to clusters</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 518</span> <span style="color: #A0A0A0; background: #FFFFFF;">                previdx = idx;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 519</span> <span style="color: #A0A0A0; background: #FFFFFF;">                prevtotsumD = totsumD;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 520</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [d, nidx] = min(D, [], 2);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 521</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 522</span> <span style="color: #228B22; background: #FFFFFF;">                % Determine which points moved</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 523</span> <span style="color: #A0A0A0; background: #FFFFFF;">                moved = find(nidx ~= previdx);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 524</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(moved)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 525</span> <span style="color: #228B22; background: #FFFFFF;">                    % Resolve ties in favor of not moving</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 526</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    moved = moved(D((previdx(moved)-1)*n + moved) &gt; d(moved));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 527</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 528</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isempty(moved)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 529</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    converged = true;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 530</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    break;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 531</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 532</span> <span style="color: #A0A0A0; background: #FFFFFF;">                idx(moved) = nidx(moved);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 533</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 534</span> <span style="color: #228B22; background: #FFFFFF;">                % Find clusters that gained or lost members</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 535</span> <span style="color: #A0A0A0; background: #FFFFFF;">                changed = unique([idx(moved); previdx(moved)])';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 536</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 537</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end % phase one</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 538</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 539</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % nested function</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 540</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 541</span> <span style="color: #228B22; background: #FFFFFF;">        %------------------------------------------------------------------</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 542</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 543</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function converged = onlineUpdate()</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 544</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 545</span> <span style="color: #228B22; background: #FFFFFF;">            % Initialize some cluster information prior to phase two</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 546</span> <span style="color: #A0A0A0; background: #FFFFFF;">            switch distance</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 547</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'cityblock'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 548</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    Xmid = zeros([k,p,2]);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 549</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    for i = 1:k</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 550</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if m(i) &gt; 0</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 551</span> <span style="color: #228B22; background: #FFFFFF;">                            % Separate out sorted coords for points in i'th cluster,</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 552</span> <span style="color: #228B22; background: #FFFFFF;">                            % and save values above and below median, component-wise</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 553</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            Xsorted = sort(X(idx==i,:),1);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 554</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            nn = floor(.5*m(i));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 555</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if mod(m(i),2) == 0</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 556</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Xmid(i,:,1:2) = Xsorted([nn, nn+1],:)';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 557</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            elseif m(i) &gt; 1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 558</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Xmid(i,:,1:2) = Xsorted([nn, nn+2],:)';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 559</span> <span style="color: #228B22; background: #FFFFFF;">                            else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 560</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Xmid(i,:,1:2) = Xsorted([1, 1],:)';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 561</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 562</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 563</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 564</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'hamming'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 565</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    Xsum = zeros(k,p);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 566</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    for i = 1:k</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 567</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if m(i) &gt; 0</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 568</span> <span style="color: #228B22; background: #FFFFFF;">                            % Sum coords for points in i'th cluster, component-wise</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 569</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            Xsum(i,:) = sum(X(idx==i,:), 1);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 570</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 571</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 572</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 573</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 574</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 575</span> <span style="color: #228B22; background: #FFFFFF;">            % Begin phase two:  single reassignments</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 576</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 577</span> <span style="color: #A0A0A0; background: #FFFFFF;">            changed = find(m' &gt; 0);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 578</span> <span style="color: #A0A0A0; background: #FFFFFF;">            lastmoved = 0;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 579</span> <span style="color: #A0A0A0; background: #FFFFFF;">            nummoved = 0;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 580</span> <span style="color: #A0A0A0; background: #FFFFFF;">            iter1 = iter;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 581</span> <span style="color: #A0A0A0; background: #FFFFFF;">            converged = false;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 582</span> <span style="color: #A0A0A0; background: #FFFFFF;">            Del = NaN(n,k); % reassignment criterion</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 583</span> <span style="color: #A0A0A0; background: #FFFFFF;">            while iter &lt; maxit</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 584</span> <span style="color: #228B22; background: #FFFFFF;">                % Calculate distances to each cluster from each point, and the</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 585</span> <span style="color: #228B22; background: #FFFFFF;">                % potential change in total sum of errors for adding or removing</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 586</span> <span style="color: #228B22; background: #FFFFFF;">                % each point from each cluster.  Clusters that have not changed</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 587</span> <span style="color: #228B22; background: #FFFFFF;">                % membership need not be updated.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 588</span> <span style="color: #228B22; background: #FFFFFF;">                %</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 589</span> <span style="color: #228B22; background: #FFFFFF;">                % Singleton clusters are a special case for the sum of dists</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 590</span> <span style="color: #228B22; background: #FFFFFF;">                % calculation.  Removing their only point is never best, so the</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 591</span> <span style="color: #228B22; background: #FFFFFF;">                % reassignment criterion had better guarantee that a singleton</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 592</span> <span style="color: #228B22; background: #FFFFFF;">                % point will stay in its own cluster.  Happily, we get</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 593</span> <span style="color: #228B22; background: #FFFFFF;">                % Del(i,idx(i)) == 0 automatically for them.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 594</span> <span style="color: #A0A0A0; background: #FFFFFF;">                switch distance</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 595</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    case 'sqeuclidean'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 596</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        for i = changed</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 597</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            mbrs = (idx == i);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 598</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            sgn = 1 - 2*mbrs; % -1 for members, 1 for nonmembers</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 599</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if m(i) == 1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 600</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                sgn(mbrs) = 0; % prevent divide-by-zero for singleton mbrs</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 601</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 602</span> <span style="color: #A0A0A0; background: #FFFFFF;">                          Del(:,i) = (m(i) ./ (m(i) + sgn)) .* sum((bsxfun(@minus, X, C(i,:))).^2, 2);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 603</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 604</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    case 'cityblock'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 605</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        for i = changed</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 606</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if mod(m(i),2) == 0 % this will never catch singleton clusters</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 607</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                ldist = bsxfun(@minus, Xmid(i,:,1), X);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 608</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                rdist = bsxfun(@minus, X, Xmid(i,:,2));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 609</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                mbrs = (idx == i);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 610</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                sgn = repmat(1-2*mbrs, 1, p); % -1 for members, 1 for nonmembers</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 611</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Del(:,i) = sum(max(0, max(sgn.*rdist, sgn.*ldist)), 2);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 612</span> <span style="color: #228B22; background: #FFFFFF;">                            else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 613</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Del(:,i) = sum(abs(bsxfun(@minus, X, C(i,:))), 2);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 614</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 615</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 616</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    case {'cosine','correlation'}</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 617</span> <span style="color: #228B22; background: #FFFFFF;">                        % The points are normalized, centroids are not, so normalize them</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 618</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        normC = sqrt(sum(C.^2, 2));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 619</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if any(normC &lt; eps(class(normC))) % small relative to unit-length data points</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 620</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if reps==1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 621</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                error(message('stats:kmeans:ZeroCentroid', iter));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 622</span> <span style="color: #228B22; background: #FFFFFF;">                            else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 623</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                error(message('stats:kmeans:ZeroCentroidRep', iter, rep));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 624</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 625</span> <span style="color: #228B22; background: #FFFFFF;">                            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 626</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 627</span> <span style="color: #228B22; background: #FFFFFF;">                        % This can be done without a loop, but the loop saves memory allocations</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 628</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        for i = changed</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 629</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            XCi = X * C(i,:)';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 630</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            mbrs = (idx == i);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 631</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            sgn = 1 - 2*mbrs; % -1 for members, 1 for nonmembers</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 632</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            Del(:,i) = 1 + sgn .*...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 633</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                (m(i).*normC(i) - sqrt((m(i).*normC(i)).^2 + 2.*sgn.*m(i).*XCi + 1));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 634</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 635</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    case 'hamming'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 636</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        for i = changed</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 637</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if mod(m(i),2) == 0 % this will never catch singleton clusters</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 638</span> <span style="color: #228B22; background: #FFFFFF;">                                % coords with an unequal number of 0s and 1s have a</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 639</span> <span style="color: #228B22; background: #FFFFFF;">                                % different contribution than coords with an equal</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 640</span> <span style="color: #228B22; background: #FFFFFF;">                                % number</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 641</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                unequal01 = find(2*Xsum(i,:) ~= m(i));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 642</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                numequal01 = p - length(unequal01);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 643</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                mbrs = (idx == i);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 644</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Di = abs(bsxfun(@minus,X(:,unequal01), C(i,unequal01)));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 645</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Del(:,i) = (sum(Di, 2) + mbrs*numequal01) / p;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 646</span> <span style="color: #228B22; background: #FFFFFF;">                            else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 647</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Del(:,i) = sum(abs(bsxfun(@minus,X,C(i,:))), 2) / p;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 648</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 649</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 650</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 651</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 652</span> <span style="color: #228B22; background: #FFFFFF;">                % Determine best possible move, if any, for each point.  Next we</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 653</span> <span style="color: #228B22; background: #FFFFFF;">                % will pick one from those that actually did move.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 654</span> <span style="color: #A0A0A0; background: #FFFFFF;">                previdx = idx;</span><br/></pre></td></tr><tr><a name="Line655"></a><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 655</span> <span style="color: #A0A0A0; background: #FFFFFF;">                prevtotsumD = totsumD;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 656</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [minDel, nidx] = min(Del, [], 2);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 657</span> <span style="color: #A0A0A0; background: #FFFFFF;">                moved = find(previdx ~= nidx);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 658</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(moved)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 659</span> <span style="color: #228B22; background: #FFFFFF;">                    % Resolve ties in favor of not moving</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 660</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    moved = moved(Del((previdx(moved)-1)*n + moved) &gt; minDel(moved));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 661</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 662</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isempty(moved)</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 663</span> <span style="color: #228B22; background: #FFFFFF;">                    % Count an iteration if phase 2 did nothing at all, or if we're</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 664</span> <span style="color: #228B22; background: #FFFFFF;">                    % in the middle of a pass through all the points</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 665</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if (iter == iter1) || nummoved &gt; 0</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 666</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        iter = iter + 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 667</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if display &gt; 2 % 'iter'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 668</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if usePool</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 669</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                fprintf(dispfmt,labindx,iter,2,length(moved),totsumD);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 670</span> <span style="color: #228B22; background: #FFFFFF;">                            else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 671</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                fprintf(dispfmt,iter,2,length(moved),totsumD);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 672</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 673</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 674</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 675</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    converged = true;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 676</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    break;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 677</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 678</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 679</span> <span style="color: #228B22; background: #FFFFFF;">                % Pick the next move in cyclic order</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 680</span> <span style="color: #A0A0A0; background: #FFFFFF;">                moved = mod(min(mod(moved - lastmoved - 1, n) + lastmoved), n) + 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 681</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 682</span> <span style="color: #228B22; background: #FFFFFF;">                % If we've gone once through all the points, that's an iteration</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 683</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if moved &lt;= lastmoved</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 684</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    iter = iter + 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 685</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if display &gt; 2 % 'iter'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 686</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if usePool</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 687</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            fprintf(dispfmt,labindx,iter,2,length(moved),totsumD);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 688</span> <span style="color: #228B22; background: #FFFFFF;">                        else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 689</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            fprintf(dispfmt,iter,2,length(moved),totsumD);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 690</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 691</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 692</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if iter &gt;= maxit, break; end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 693</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nummoved = 0;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 694</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 695</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nummoved = nummoved + 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 696</span> <span style="color: #A0A0A0; background: #FFFFFF;">                lastmoved = moved;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 697</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 698</span> <span style="color: #A0A0A0; background: #FFFFFF;">                oidx = idx(moved);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 699</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nidx = nidx(moved);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 700</span> <span style="color: #A0A0A0; background: #FFFFFF;">                totsumD = totsumD + Del(moved,nidx) - Del(moved,oidx);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 701</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 702</span> <span style="color: #228B22; background: #FFFFFF;">                % Update the cluster index vector, and the old and new cluster</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 703</span> <span style="color: #228B22; background: #FFFFFF;">                % counts and centroids</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 704</span> <span style="color: #A0A0A0; background: #FFFFFF;">                idx(moved) = nidx;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 705</span> <span style="color: #A0A0A0; background: #FFFFFF;">                m(nidx) = m(nidx) + 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 706</span> <span style="color: #A0A0A0; background: #FFFFFF;">                m(oidx) = m(oidx) - 1;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 707</span> <span style="color: #A0A0A0; background: #FFFFFF;">                switch distance</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 708</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    case 'sqeuclidean'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 709</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        C(nidx,:) = C(nidx,:) + (X(moved,:) - C(nidx,:)) / m(nidx);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 710</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        C(oidx,:) = C(oidx,:) - (X(moved,:) - C(oidx,:)) / m(oidx);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 711</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    case 'cityblock'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 712</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        for i = [oidx nidx]</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 713</span> <span style="color: #228B22; background: #FFFFFF;">                            % Separate out sorted coords for points in each cluster.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 714</span> <span style="color: #228B22; background: #FFFFFF;">                            % New centroid is the coord median, save values above and</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 715</span> <span style="color: #228B22; background: #FFFFFF;">                            % below median.  All done component-wise.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 716</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            Xsorted = sort(X(idx==i,:),1);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 717</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            nn = floor(.5*m(i));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 718</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if mod(m(i),2) == 0</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 719</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                C(i,:) = .5 * (Xsorted(nn,:) + Xsorted(nn+1,:));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 720</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                Xmid(i,:,1:2) = Xsorted([nn, nn+1],:)';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 721</span> <span style="color: #228B22; background: #FFFFFF;">                            else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 722</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                C(i,:) = Xsorted(nn+1,:);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 723</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                if m(i) &gt; 1</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 724</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                    Xmid(i,:,1:2) = Xsorted([nn, nn+2],:)';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 725</span> <span style="color: #228B22; background: #FFFFFF;">                                else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 726</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                    Xmid(i,:,1:2) = Xsorted([1, 1],:)';</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 727</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 728</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 729</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 730</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    case {'cosine','correlation'}</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 731</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        C(nidx,:) = C(nidx,:) + (X(moved,:) - C(nidx,:)) / m(nidx);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 732</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        C(oidx,:) = C(oidx,:) - (X(moved,:) - C(oidx,:)) / m(oidx);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 733</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    case 'hamming'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 734</span> <span style="color: #228B22; background: #FFFFFF;">                        % Update summed coords for points in each cluster.  New</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 735</span> <span style="color: #228B22; background: #FFFFFF;">                        % centroid is the coord median.  All done component-wise.</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 736</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        Xsum(nidx,:) = Xsum(nidx,:) + X(moved,:);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 737</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        Xsum(oidx,:) = Xsum(oidx,:) - X(moved,:);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 738</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        C(nidx,:) = .5*sign(2*Xsum(nidx,:) - m(nidx)) + .5;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 739</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        C(oidx,:) = .5*sign(2*Xsum(oidx,:) - m(oidx)) + .5;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 740</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 741</span> <span style="color: #A0A0A0; background: #FFFFFF;">                changed = sort([oidx nidx]);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 742</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end % phase two</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 743</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 744</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % nested function</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 745</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 746</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">          0b/48b/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 747</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    250 </span></td><td><span style="color: #20AF20">        0b/21.9k/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 748</span> <span style="color: #000000; background: #FFFFFF;">end % main function </span><br/></pre></td></tr></table><p><p>Other subfunctions in this file are not included in this listing.</body></html>