<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /><link rel="stylesheet" href="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for gmmem_weighted</title><link rel="stylesheet" href="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">gmmem_weighted (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/><i>Generated 03-Apr-2014 11:11:30 using cpu time.</i><br/>function in file /Users/juan/Documents/janelia/cbtrack_GUI/gmmem_weighted.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file67.html">mygmm</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">44529</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Allocated Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Freed Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Peak Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line81">81</a></td><td class="td-linebottomrt"><pre>[post, act] = gmmpost(mix, x);</pre></td><td class="td-linebottomrt">229508</td><td class="td-linebottomrt">244.647 s</td><td class="td-linebottomrt">3509490.16 Kb</td><td class="td-linebottomrt">3853447.95 Kb</td><td class="td-linebottomrt">1998.50 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">59.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=59 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line172">172</a></td><td class="td-linebottomrt"><pre>if min(svd(mix.covars(:,:,j)))...</pre></td><td class="td-linebottomrt">369984</td><td class="td-linebottomrt">16.151 s</td><td class="td-linebottomrt">11811.64 Kb</td><td class="td-linebottomrt">25725.39 Kb</td><td class="td-linebottomrt">1295.94 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">3.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line164">164</a></td><td class="td-linebottomrt"><pre>diffs = x - (ones(ndata, 1) * ...</pre></td><td class="td-linebottomrt">369984</td><td class="td-linebottomrt">13.678 s</td><td class="td-linebottomrt">320175.52 Kb</td><td class="td-linebottomrt">85768.66 Kb</td><td class="td-linebottomrt">220.00 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">3.3%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line166">166</a></td><td class="td-linebottomrt"><pre>mix.covars(:,:,j) = (diffs'*di...</pre></td><td class="td-linebottomrt">369984</td><td class="td-linebottomrt">13.334 s</td><td class="td-linebottomrt">20399.34 Kb</td><td class="td-linebottomrt">11742.12 Kb</td><td class="td-linebottomrt">308.14 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">3.2%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line165">165</a></td><td class="td-linebottomrt"><pre>diffs = diffs.*(sqrt(post(:,j)...</pre></td><td class="td-linebottomrt">369984</td><td class="td-linebottomrt">11.773 s</td><td class="td-linebottomrt">9298.62 Kb</td><td class="td-linebottomrt">24658.72 Kb</td><td class="td-linebottomrt">432.00 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">2.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">115.320 s</td><td class="td-linebottomrt">457199.38 Kb</td><td class="td-linebottomrt">890712.38 Kb</td><td class="td-linebottomrt">1998.50 Kb</td><td class="td-linebottomrt">27.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=28 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">414.902 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">4328374.66 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">4892055.22 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">1998.50 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Allocated Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Freed Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Peak Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file173.html">gmmpost</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">229508</td><td class="td-linebottomrt">238.580 s</td><td class="td-linebottomrt">3504911.16 Kb</td><td class="td-linebottomrt">3065821.03 Kb</td><td class="td-linebottomrt">1998.50 Kb</td><td class="td-linebottomrt">57.5%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=58 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file176.html">consist</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">44529</td><td class="td-linebottomrt">8.622 s</td><td class="td-linebottomrt">14737.94 Kb</td><td class="td-linebottomrt">19411.67 Kb</td><td class="td-linebottomrt">128.47 Kb</td><td class="td-linebottomrt">2.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file175.html">gmmprob</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">13</td><td class="td-linebottomrt">0.006 s</td><td class="td-linebottomrt">152.30 Kb</td><td class="td-linebottomrt">113.81 Kb</td><td class="td-linebottomrt">11.66 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">167.694 s</td><td class="td-linebottomrt">808573.27 Kb</td><td class="td-linebottomrt">1806708.70 Kb</td><td class="td-linebottomrt">1998.50 Kb</td><td class="td-linebottomrt">40.4%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2013b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=40 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">414.902 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">4328374.66 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">4892055.22 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">1998.50 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line44">44</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'xdim' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line84">84</a></td><td class="td-linebottomrt"><span class="mono">Use || instead of | as the OR operator in (scalar) conditional statements.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line84">84</a></td><td class="td-linebottomrt"><span class="mono">Use || instead of | as the OR operator in (scalar) conditional statements.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line96">96</a></td><td class="td-linebottomrt"><span class="mono">Use && instead of & as the AND operator in (scalar) conditional statements.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">208</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">67</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">141</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">73</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">68</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">51.77 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table border = "0" cellpadding = "1" cellspacing = "5"><style> td,th { text-align:center; } .leftAligned{ text-align:left; }</style><tr><th><span style="color: #FF0000; font-weight: bold; text-decoration: none">time</span> </th><th><span style="color: #0000FF; font-weight: bold; text-decoration: none">calls</span> </th><th><span style="color: #20AF20; font-weight: bold; text-decoration: none">mem</span> </th><th class="leftAligned"><span style="font-weight: bold; text-decoration: none">  line</span></th></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [mix, options, errlog, post] = gmmem_weighted(mix, x, w, options)</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%GMMEM	EM algorithm for Gaussian mixture model.</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%	Description</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%	[MIX, OPTIONS, ERRLOG] = GMMEM(MIX, X, OPTIONS) uses the Expectation</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%	Maximization algorithm of Dempster et al. to estimate the parameters</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%	of a Gaussian mixture model defined by a data structure MIX. The</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%	matrix X represents the data whose expectation is maximized, with</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%	each row corresponding to a vector.    The optional parameters have</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%	the following interpretations.</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%	OPTIONS(1) is set to 1 to display error values; also logs error</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%	values in the return argument ERRLOG. If OPTIONS(1) is set to 0, then</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%	only warning messages are displayed.  If OPTIONS(1) is -1, then</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%	nothing is displayed.</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%	OPTIONS(3) is a measure of the absolute precision required of the</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%	error function at the solution. If the change in log likelihood</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%	between two steps of the EM algorithm is less than this value, then</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%	the function terminates.</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%	OPTIONS(5) is set to 1 if a covariance matrix is reset to its</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%	original value when any of its singular values are too small (less</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%	than MIN_COVAR which has the value eps).   With the default value of</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%	0 no action is taken.</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%	OPTIONS(14) is the maximum number of iterations; default 100.</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%	The optional return value OPTIONS contains the final error value</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%	(i.e. data log likelihood) in OPTIONS(8).</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%	See also</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%	GMM, GMMINIT</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%	Copyright (c) Ian T Nabney (1996-2001)</span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td> (44529 calls, 414.902 sec, 4328374.66 Kb, 4892055.22 Kb, 1998.50 Kb)</span><br/></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">% Check that inputs are consistent</span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 10.24 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">   16.1m/20.9m/128k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  39</span> <span style="color: #000000; background: #FFFFFF;">errstring = <a href="file176.html">consist</a>(mix, 'gmm', x); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.49 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">   1.96m/588k/96.7k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  40</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(errstring) </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.96m/588k/96.7k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  41</span> <span style="color: #A0A0A0; background: #FFFFFF;">  error(errstring);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.96m/588k/96.7k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  42</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.96m/588k/96.7k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><a name="Line44"></a><td><span style="color: #FF0000">  0.23 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">      293k/321k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  44</span> <span style="color: #000000; background: #FFFFFF;">[ndata, xdim] = size(x); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      293k/321k/32k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      293k/321k/32k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">% Sort out the options</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.25 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">    236k/358k/1.56k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  47</span> <span style="color: #000000; background: #FFFFFF;">if (options(14)) </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.21 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">     244k/272k/5.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  48</span> <span style="color: #000000; background: #FFFFFF;">  niters = options(14); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     244k/272k/5.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     244k/272k/5.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  50</span> <span style="color: #A0A0A0; background: #FFFFFF;">  niters = 100;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     244k/272k/5.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  51</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     244k/272k/5.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.09 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">      280k/346k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  53</span> <span style="color: #000000; background: #FFFFFF;">display = options(1); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.13 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">       249k/242k/6k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  54</span> <span style="color: #000000; background: #FFFFFF;">store = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.18 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">       280k/318k/8k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  55</span> <span style="color: #000000; background: #FFFFFF;">if (nargout &gt; 2) </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.19 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">       236k/434k/8k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  56</span> <span style="color: #000000; background: #FFFFFF;">  store = 1;	% Store the error values to return them </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.64 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">   35.4m/169k/64.8k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  57</span> <span style="color: #000000; background: #FFFFFF;">  errlog = zeros(1, niters); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">      295k/310k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  58</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.18 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">     216k/346k/528b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  59</span> <span style="color: #000000; background: #FFFFFF;">test = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">       238k/242k/8k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  60</span> <span style="color: #000000; background: #FFFFFF;">if options(3) &gt; 0.0 </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">    205k/298k/1.56k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  61</span> <span style="color: #000000; background: #FFFFFF;">  test = 1;	% Test log likelihood for termination </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.19 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">    232k/228k/4.05k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  62</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    232k/228k/4.05k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.19 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">     237k/308k/528b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  64</span> <span style="color: #000000; background: #FFFFFF;">check_covars = 0; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.21 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">       272k/375k/8k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  65</span> <span style="color: #000000; background: #FFFFFF;">if options(5) &gt; 0, </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">     252k/409k/5.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  66</span> <span style="color: #000000; background: #FFFFFF;">  if display &gt;= 0, </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     252k/409k/5.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  67</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp('check_covars is on');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     252k/409k/5.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  68</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.16 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">      285k/360k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  69</span> <span style="color: #000000; background: #FFFFFF;">  check_covars = 1;	% Ensure that covariances don't collapse </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.17 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">    285k/454k/31.7k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  70</span> <span style="color: #000000; background: #FFFFFF;">  MIN_COVAR = options(5);	% Minimum singular value of covariance matrix </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.35 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">    1.92m/687k/160k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  71</span> <span style="color: #000000; background: #FFFFFF;">  init_covars = mix.covars; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.23 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">      281k/242k/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  72</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">      281k/242k/32k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.04 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">   24.4m/1.28m/504k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  74</span> <span style="color: #000000; background: #FFFFFF;">w = w / sum(w); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.14 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">    102m/70.9m/464k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  75</span> <span style="color: #000000; background: #FFFFFF;">w = repmat(w(:),[1,mix.ncentres]); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    102m/70.9m/464k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    102m/70.9m/464k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;">% Main loop of algorithm</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.91 </span></td><td><span style="color: #0000FF">  44529 </span></td><td><span style="color: #20AF20">8.26m/1.02e+03k/64.9k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  78</span> <span style="color: #000000; background: #FFFFFF;">for n = 1:niters </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">8.26m/1.02e+03k/64.9k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">8.26m/1.02e+03k/64.9k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">  % Calculate posteriors based on old parameters</span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 244.65 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">  3.35g/3.67g/1.95m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  81</span> <a name="Line81"></a><span style="color: #000000; background: #FF8080;">  [post, act] = <a href="file173.html">gmmpost</a>(mix, x); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  3.35g/3.67g/1.95m </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  3.35g/3.67g/1.95m </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF;">  % Calculate error value if needed</span><br/></pre></td></tr><tr><a name="Line84"></a><td><span style="color: #FF0000">  3.37 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">   3.27m/3.79m/150k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  84</span> <span style="color: #000000; background: #FFFFFF;">  if (display | store | test) </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  4.73 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">    8.85m/203m/259k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  85</span> <span style="color: #000000; background: #FFFFFF;">    prob = act*(mix.priors)'; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.58 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">     30m/3.87m/468k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  86</span> <span style="color: #000000; background: #FFFFFF;">    prob(prob&lt;=eps) = eps; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     30m/3.87m/468k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF;">    % Error value is negative log likelihood of data</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  8.37 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">   77.1m/50.5m/446k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  88</span> <span style="color: #000000; background: #FFFFFF;">    e = - sum(log(prob)); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.43 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">   1.32m/1.58m/132k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  89</span> <span style="color: #000000; background: #FFFFFF;">    if store </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.02 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">   1.3m/1.39m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  90</span> <span style="color: #000000; background: #FFFFFF;">      errlog(n) = e; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.77 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">     1.73m/2m/32.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  91</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.60 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">   2.23m/2.05m/308k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  92</span> <span style="color: #000000; background: #FFFFFF;">    if display &gt; 0 </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   2.23m/2.05m/308k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  93</span> <span style="color: #A0A0A0; background: #FFFFFF;">      fprintf(1, 'Cycle %4d  Error %11.6f\n', n, e);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   2.23m/2.05m/308k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0">  94</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.28 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">   1.5m/2.75m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  95</span> <span style="color: #000000; background: #FFFFFF;">    if test </span><br/></pre></td></tr><tr><a name="Line96"></a><td><span style="color: #FF0000">  3.73 </span></td><td><span style="color: #0000FF"> 229508 </span></td><td><span style="color: #20AF20">  5.73m/4.44m/47.1k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  96</span> <span style="color: #000000; background: #FFFFFF;">      if (n &gt; 1 &amp; abs(e - eold) &lt; options(3)) </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.38 </span></td><td><span style="color: #0000FF">  44516 </span></td><td><span style="color: #20AF20">     602k/478k/196k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  97</span> <span style="color: #000000; background: #FFFFFF;">        options(8) = e; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.61 </span></td><td><span style="color: #0000FF">  44516 </span></td><td><span style="color: #20AF20">     377k/7.27m/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  98</span> <span style="color: #000000; background: #FFFFFF;">        return; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.03 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">       814k/992k/8k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold">  99</span> <span style="color: #228B22; background: #FFFFFF;">      else </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.40 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">  1.53m/1.94m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 100</span> <span style="color: #000000; background: #FFFFFF;">        eold = e; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.00 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">  1.09m/1.14m/86.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 101</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.84 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">     2m/1.21m/1.06m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 102</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.92 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">    2.32m/2.7m/220k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 103</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    2.32m/2.7m/220k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.92 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">    1.71m/2.29m/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 105</span> <span style="color: #000000; background: #FFFFFF;">  post = post .* w; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    1.71m/2.29m/32k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    1.71m/2.29m/32k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF;">  % Adjust the new estimates for the parameters</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  4.70 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">   16.7m/5.01m/164k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 108</span> <span style="color: #000000; background: #FFFFFF;">  new_pr = sum(post, 1); </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   16.7m/5.01m/164k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 109</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   16.7m/5.01m/164k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;">  % allow centers to be dropped</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.33 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">    4.9m/4.71m/372k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 111</span> <span style="color: #000000; background: #FFFFFF;">  idxdrop = new_pr &lt;= 1e-6; </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.58 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">    2.34m/4.14m/35k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 112</span> <span style="color: #000000; background: #FFFFFF;">  if any(idxdrop), </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    2.34m/4.14m/35k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 113</span> <span style="color: #A0A0A0; background: #FFFFFF;">    post(:,idxdrop) = 0;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    2.34m/4.14m/35k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 114</span> <span style="color: #A0A0A0; background: #FFFFFF;">    new_pr = sum(post,1);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    2.34m/4.14m/35k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 115</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    2.34m/4.14m/35k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.29 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">  8.38m/3.58m/32.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 117</span> <span style="color: #000000; background: #FFFFFF;">  new_c = post' * x; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  8.38m/3.58m/32.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  8.38m/3.58m/32.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;">  % Now move new estimates to old parameter vectors</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.19 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">  5.59m/10.3m/32.1k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 120</span> <span style="color: #000000; background: #FFFFFF;">  mix.priors = new_pr;% ./ ndata; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  5.59m/10.3m/32.1k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.99 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">   8.24m/5.47m/172k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 122</span> <span style="color: #000000; background: #FFFFFF;">  mix.centres = new_c ./ (new_pr' * ones(1, mix.nin)); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.13 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">   2.85m/3.73m/188k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 123</span> <span style="color: #000000; background: #FFFFFF;">  mix.centres(idxdrop,:) = nan; </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   2.85m/3.73m/188k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.09 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">    1.81m/2.47m/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 125</span> <span style="color: #000000; background: #FFFFFF;">  switch mix.covar_type </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.26 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 126</span> <span style="color: #000000; background: #FFFFFF;">  case 'spherical' </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 127</span> <span style="color: #A0A0A0; background: #FFFFFF;">    n2 = netlab_dist2(x, mix.centres);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 128</span> <span style="color: #A0A0A0; background: #FFFFFF;">    v = nan(1,mix.ncentres);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 129</span> <span style="color: #A0A0A0; background: #FFFFFF;">    for j = 1:mix.ncentres</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 130</span> <span style="color: #A0A0A0; background: #FFFFFF;">      v(j) = (post(:,j)'*n2(:,j));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 131</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 132</span> <span style="color: #A0A0A0; background: #FFFFFF;">    mix.covars = ((v./new_pr))./mix.nin;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 133</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if check_covars</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;">      % Ensure that no covariance is too small</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 135</span> <span style="color: #A0A0A0; background: #FFFFFF;">      for j = 1:mix.ncentres</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 136</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if mix.covars(j) &lt; MIN_COVAR</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 137</span> <span style="color: #A0A0A0; background: #FFFFFF;">          mix.covars(j) = init_covars(j);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 138</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 139</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.29m/1.77m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 140</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.15 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">  case 'diag' </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 142</span> <span style="color: #A0A0A0; background: #FFFFFF;">    for j = 1:mix.ncentres</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 143</span> <span style="color: #A0A0A0; background: #FFFFFF;">      if idxdrop(j),</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 144</span> <span style="color: #A0A0A0; background: #FFFFFF;">        mix.covars(j,:) = init_covars(j,:);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 145</span> <span style="color: #228B22; background: #FFFFFF;">      else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 146</span> <span style="color: #A0A0A0; background: #FFFFFF;">        diffs = x - (ones(ndata, 1) * mix.centres(j,:));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 147</span> <span style="color: #A0A0A0; background: #FFFFFF;">        mix.covars(j,:) = sum((diffs.*diffs).*(post(:,j)*ones(1, ...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 148</span> <span style="color: #A0A0A0; background: #FFFFFF;">          mix.nin)), 1)./new_pr(j);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 149</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 150</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 151</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if check_covars</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 152</span> <span style="color: #228B22; background: #FFFFFF;">      % Ensure that no covariance is too small</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 153</span> <span style="color: #A0A0A0; background: #FFFFFF;">      for j = 1:mix.ncentres</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 154</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if min(mix.covars(j,:)) &lt; MIN_COVAR</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 155</span> <span style="color: #A0A0A0; background: #FFFFFF;">          mix.covars(j,:) = init_covars(j,:);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 156</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 157</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   1.75m/1.95m/260k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 158</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.06 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">   1.81m/1.44m/408k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 159</span> <span style="color: #000000; background: #FFFFFF;">  case 'full' </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  4.37 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">  24.8m/4.33m/96.6k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 160</span> <span style="color: #000000; background: #FFFFFF;">    for j = 1:mix.ncentres </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  6.45 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">   6.47m/13.1m/431k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 161</span> <span style="color: #000000; background: #FFFFFF;">      if idxdrop(j), </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">   6.47m/13.1m/431k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 162</span> <span style="color: #A0A0A0; background: #FFFFFF;">        mix.covars(:,:,j) = init_covars(:,:,j);</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.62 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">  3.07m/1.99m/1.06m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 163</span> <span style="color: #228B22; background: #FFFFFF;">      else </span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 13.68 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">    313m/83.8m/220k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 164</span> <a name="Line164"></a><span style="color: #000000; background: #FFFFFF;">        diffs = x - (ones(ndata, 1) * mix.centres(j,:)); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 11.77 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">   9.08m/24.1m/432k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 165</span> <a name="Line165"></a><span style="color: #000000; background: #FFFFFF;">        diffs = diffs.*(sqrt(post(:,j))*ones(1, mix.nin)); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 13.33 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">   19.9m/11.5m/308k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 166</span> <a name="Line166"></a><span style="color: #000000; background: #FFFFFF;">        mix.covars(:,:,j) = (diffs'*diffs)/new_pr(j); </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.32 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">    2.09m/2.68m/44k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 167</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  3.23 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">      3m/14.7m/448k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 168</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.79 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">     852k/1.47m/32k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 169</span> <span style="color: #000000; background: #FFFFFF;">    if check_covars </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">     852k/1.47m/32k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 170</span> <span style="color: #228B22; background: #FFFFFF;">      % Ensure that no covariance is too small</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  0.79 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">    1.21m/1.1m/118k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 171</span> <span style="color: #000000; background: #FFFFFF;">      for j = 1:mix.ncentres </span><br/></pre></td></tr><tr><td><span style="color: #FF0000"> 16.15 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">  11.5m/25.1m/1.27m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 172</span> <a name="Line172"></a><span style="color: #000000; background: #FFFFFF;">        if min(svd(mix.covars(:,:,j))) &lt; MIN_COVAR </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">    396 </span></td><td><span style="color: #20AF20">      6.73k/0b/544b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 173</span> <span style="color: #000000; background: #FFFFFF;">          mix.covars(:,:,j) = init_covars(:,:,j); </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">    396 </span></td><td><span style="color: #20AF20">      6.73k/0b/544b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 174</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  2.10 </span></td><td><span style="color: #0000FF"> 369984 </span></td><td><span style="color: #20AF20">  2.89m/2.47m/1.06m </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 175</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.76 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 176</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 177</span> <span style="color: #A0A0A0; background: #FFFFFF;">  case 'ppca'</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 178</span> <span style="color: #A0A0A0; background: #FFFFFF;">    for j = 1:mix.ncentres</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 179</span> <span style="color: #A0A0A0; background: #FFFFFF;">      if idxdrop(j),</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 180</span> <span style="color: #A0A0A0; background: #FFFFFF;">        mix.covars(j) = init_covars(j);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 181</span> <span style="color: #228B22; background: #FFFFFF;">      else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 182</span> <span style="color: #A0A0A0; background: #FFFFFF;">        diffs = x - (ones(ndata, 1) * mix.centres(j,:));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 183</span> <span style="color: #A0A0A0; background: #FFFFFF;">        diffs = diffs.*(sqrt(post(:,j))*ones(1, mix.nin));</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 184</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [tempcovars, tempU, templambda] = ...</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 185</span> <span style="color: #A0A0A0; background: #FFFFFF;">          ppca((diffs'*diffs)/new_pr(j), mix.ppca_dim);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 186</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if length(templambda) ~= mix.ppca_dim</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 187</span> <span style="color: #A0A0A0; background: #FFFFFF;">          error('Unable to extract enough components');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 188</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 189</span> <span style="color: #A0A0A0; background: #FFFFFF;">          mix.covars(j) = tempcovars;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 190</span> <span style="color: #A0A0A0; background: #FFFFFF;">          mix.U(:, :, j) = tempU;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 191</span> <span style="color: #A0A0A0; background: #FFFFFF;">          mix.lambda(j, :) = templambda;</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 192</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 193</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 194</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 195</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if check_covars</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 196</span> <span style="color: #A0A0A0; background: #FFFFFF;">      if mix.covars(j) &lt; MIN_COVAR</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 197</span> <span style="color: #A0A0A0; background: #FFFFFF;">        mix.covars(j) = init_covars(j);</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 198</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 199</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 200</span> <span style="color: #A0A0A0; background: #FFFFFF;">    otherwise</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 201</span> <span style="color: #A0A0A0; background: #FFFFFF;">      error(['Unknown covariance type ', mix.covar_type]);               </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">  1.77m/2.63m/64.5k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 202</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/></pre></td></tr><tr><td><span style="color: #FF0000">  1.13 </span></td><td><span style="color: #0000FF"> 184992 </span></td><td><span style="color: #20AF20">    1.4m/1.64m/164k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 203</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">    1.4m/1.64m/164k </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 204</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/></pre></td></tr><tr><td><span style="color: #FF0000">&lt; 0.01 </span></td><td><span style="color: #0000FF">     13 </span></td><td><span style="color: #20AF20">    154k/189k/11.7k </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 205</span> <span style="color: #000000; background: #FFFFFF;">options(8) = -sum(log(<a href="file175.html">gmmprob</a>(mix, x))); </span><br/></pre></td></tr><tr><td></td><td><span style="color: #0000FF">     13 </span></td><td><span style="color: #20AF20">        0b/1.17k/0b </span></td><td class="leftAligned"><pre><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #000000; background: #FFFFFF;">if (display &gt;= 0) </span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">        0b/1.17k/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 207</span> <span style="color: #A0A0A0; background: #FFFFFF;">  disp('Warning: Maximum number of iterations has been exceeded');</span><br/></pre></td></tr><tr><td></td><td></td><td><span style="color: #20AF20">        0b/1.17k/0b </span></td><td class="leftAligned"><pre><span style="color: #A0A0A0"> 208</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></td></tr></table><p><p>Other subfunctions in this file are not included in this listing.</body></html>